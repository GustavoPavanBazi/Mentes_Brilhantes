<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentes Brilhantes</title>
    <link rel="stylesheet" href="../css/adm_responsavel.css">
    <link rel="icon" type="image/x-icon" href="../img/LogoMB.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Bootstrap CSS (necessário para o modal) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- jQuery Mask Plugin -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <!-- Tutorial de 5 Etapas -->
    <div id="tutorial-overlay" class="tutorial-overlay active">
        <div class="tutorial-backdrop"></div>
        
        <div class="tutorial-content">
            <div class="tutorial-progress">
                <div class="tutorial-progress-bar">
                    <div class="tutorial-progress-fill" id="tutorial-progress"></div>
                </div>
                <span class="tutorial-step-counter" id="step-counter">1 / 5</span>
            </div>
    
    
            <!-- Etapa 1 -->
            <div class="tutorial-step active" data-step="1">
                <div class="tutorial-icon">
                    <i class="fas fa-lightbulb"></i>
                </div>
                <h2 class="tutorial-title">Bem-vindo!</h2>
                <p class="tutorial-description">
                    Vamos fazer um tour rápido pelas principais funcionalidades para você aproveitar ao máximo a plataforma. 
                    Este guia vai mostrar como utilizar cada recurso disponível de forma simples e direta.
                </p>
                <div class="tutorial-info-box">
                    <i class="fas fa-info-circle"></i>
                    <p>Este tutorial pode ser acessado novamente a qualquer momento através do menu de ajuda.</p>
                </div>
                <div class="tutorial-actions">
                    <button class="btn btn-primary" onclick="nextStep()">
                        Começar
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
    
    
            <!-- Etapa 2 -->
            <div class="tutorial-step" data-step="2">
                <div class="tutorial-icon">
                    <i class="fas fa-bars"></i>
                </div>
                <h2 class="tutorial-title">Menu de Navegação</h2>
                <p class="tutorial-description">
                    Use o menu lateral para navegar entre as diferentes seções do sistema. Cada seção está claramente 
                    identificada com ícones e nomes descritivos para facilitar sua localização.
                </p>
                <div class="tutorial-features-list">
                    <div class="tutorial-feature-item">
                        <i class="fas fa-home"></i>
                        <span><strong>Dashboard:</strong> Visão geral das informações</span>
                    </div>
                    <div class="tutorial-feature-item">
                        <i class="fas fa-user-doctor"></i>
                        <span><strong>Especialistas:</strong> Equipe de profissionais</span>
                    </div>
                    <div class="tutorial-feature-item">
                        <i class="fas fa-file-lines"></i>
                        <span><strong>Relatórios:</strong> Acompanhamento detalhado</span>
                    </div>
                </div>
                <div class="tutorial-actions">
                    <button class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <button class="btn btn-primary" onclick="nextStep()">
                        Próximo
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
    
    
            <!-- Etapa 3 -->
            <div class="tutorial-step" data-step="3">
                <div class="tutorial-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <h2 class="tutorial-title">Assistente Luna</h2>
                <p class="tutorial-description">
                    A Luna é sua assistente virtual especializada em TEA. Ela foi desenvolvida para oferecer suporte 
                    personalizado, responder dúvidas e auxiliar no acompanhamento diário.
                </p>
                <div class="tutorial-features-list">
                    <div class="tutorial-feature-item">
                        <i class="fas fa-comments"></i>
                        <span><strong>Conversação Natural:</strong> Faça perguntas em linguagem simples</span>
                    </div>
                    <div class="tutorial-feature-item">
                        <i class="fas fa-lightbulb"></i>
                        <span><strong>Orientações:</strong> Receba dicas e sugestões personalizadas</span>
                    </div>
                    <div class="tutorial-feature-item">
                        <i class="fas fa-calendar-check"></i>
                        <span><strong>Lembretes:</strong> Organize sua rotina e compromissos</span>
                    </div>
                </div>
                <div class="tutorial-actions">
                    <button class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <button class="btn btn-primary" onclick="nextStep()">
                        Próximo
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
    
    
            <!-- Etapa 4 -->
            <div class="tutorial-step" data-step="4">
                <div class="tutorial-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h2 class="tutorial-title">Acompanhamento de Progresso</h2>
                <p class="tutorial-description">
                    Visualize gráficos, estatísticas e relatórios detalhados sobre o desenvolvimento e atividades realizadas.
                </p>
                <div class="tutorial-features-list">
                    <div class="tutorial-feature-item">
                        <i class="fas fa-chart-bar"></i>
                        <span><strong>Gráficos Visuais:</strong> Dados apresentados de forma intuitiva</span>
                    </div>
                    <div class="tutorial-feature-item">
                        <i class="fas fa-calendar-days"></i>
                        <span><strong>Histórico:</strong> Acompanhe a evolução ao longo do tempo</span>
                    </div>
                    <div class="tutorial-feature-item">
                        <i class="fas fa-download"></i>
                        <span><strong>Exportação:</strong> Baixe relatórios em PDF</span>
                    </div>
                </div>
                <div class="tutorial-actions">
                    <button class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <button class="btn btn-primary" onclick="nextStep()">
                        Próximo
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
    
    
            <!-- Etapa 5 -->
            <div class="tutorial-step" data-step="5">
                <div class="tutorial-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2 class="tutorial-title">Pronto para Começar!</h2>
                <p class="tutorial-description">
                    Agora você está pronta para explorar todas as funcionalidades da plataforma. Para continuar, 
                    é necessário aceitar os Termos de Uso e a Política de Privacidade.
                </p>
                <div class="tutorial-info-box">
                    <i class="fas fa-shield-halved"></i>
                    <p>Seus dados são protegidos de acordo com a Lei Geral de Proteção de Dados (LGPD).</p>
                </div>
                
                <!-- Checkbox de Termos de Uso -->
                <div class="tutorial-terms">
                    <label class="tutorial-checkbox-container">
                        <input type="checkbox" id="terms-checkbox" onchange="toggleFinishButton()">
                        <span class="tutorial-checkmark"></span>
                        <span class="tutorial-checkbox-label">
                            Li e aceito os 
                            <a href="termos-de-uso.html" target="_blank" class="tutorial-link">Termos de Uso</a> 
                            e a 
                            <a href="politica-privacidade.html" target="_blank" class="tutorial-link">Política de Privacidade</a>
                        </span>
                    </label>
                </div>
                
                <div class="tutorial-actions">
                    <button class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <button class="btn btn-primary" id="finish-btn" onclick="closeTutorial()" disabled>
                        Finalizar
                        <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <header class="header">
        <div class="header-container">
            <div class="logo-section">
                <img src="../img/LogoMB.png" alt="Logo" style="width: 32px; height: 32px;">
                <span>Mentes Brilhantes</span>
            </div>
            <nav class="header-nav">
                <div class="user-profile">
                    <div class="user-avatar" id="header-avatar">M</div>
                    <div class="user-info">
                        <h4 id="header-nome">Carregando...</h4>
                        <p>Responsável</p>
                    </div>
                </div>
                <button onclick="fazerLogout()" class="btn btn-outline" style="margin-left: 1rem;">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Layout Principal -->
    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav>
                <div class="nav-section">
                    <h3 class="nav-title">Menu Principal</h3>
                    <a href="#" class="nav-item active" data-section="dashboard">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" data-section="perfil">
                        <i class="fas fa-user"></i>
                        <span>Meu Perfil</span>
                    </a>
                    <a href="#" class="nav-item" data-section="luna">
                        <i class="fas fa-robot"></i>
                        <span>Assistente Luna</span>
                    </a>
                    
                </div>

                <div class="nav-section">
                    <h3 class="nav-title">Área do Neurodivergente</h3>
                    <a href="#" class="nav-item" data-section="perfil-autista1">
                        <i class="fas fa-child"></i>
                        <span>Perfil do Autista</span>
                    </a>
                    <a href="#" class="nav-item" data-section="perfil-autista">
                        <i class="fas fa-brain"></i>
                        <span>Perfil Sensorial</span>
                    </a>
                    
                </div>

                <div class="nav-section">
                    <h3 class="nav-title">Acompanhamento</h3>
                    <a href="#" class="nav-item" data-section="progresso">
                        <i class="fas fa-chart-line"></i>
                        <span>Progresso</span>
                    </a>
                    <a href="#" class="nav-item" data-section="especialistas">
                        <i class="fas fa-user-md"></i>
                        <span>Especialistas</span>
                    </a>
                    <a href="#" class="nav-item" data-section="relatorios">
                        <i class="fas fa-file-alt"></i>
                        <span>Relatórios</span>
                    </a>
                </div>

                <div class="nav-section">
                    <h3 class="nav-title">Suporte</h3>
                    <a href="#" class="nav-item" data-section="recursos">
                        <i class="fas fa-book"></i>
                        <span>Recursos & Suporte</span>
                    </a>
                    <a href="#" class="nav-item" data-section="configuracoes">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="page-header">
                    <h1 class="page-title" id="dashboard-boas-vindas">Bem-vinda</h1>
                    <p class="page-subtitle">Acompanhe o desenvolvimento e progresso</p>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Sessões Realizadas</span>
                            <div class="stat-icon primary">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                        </div>
                        <div class="stat-number">42</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>8% este mês</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Marcos Alcançados</span>
                            <div class="stat-icon success">
                                <i class="fas fa-trophy"></i>
                            </div>
                        </div>
                        <div class="stat-number">15</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>3 novos</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Próximas Consultas</span>
                            <div class="stat-icon warning">
                                <i class="fas fa-clock"></i>
                            </div>
                        </div>
                        <div class="stat-number">3</div>
                        <div class="stat-change">
                            <i class="fas fa-calendar"></i>
                            <span>Próxima em 2 dias</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Dias Ativos</span>
                            <div class="stat-icon secondary">
                                <i class="fas fa-star"></i>
                            </div>
                        </div>
                        <div class="stat-number">89</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>Sequência atual</span>
                        </div>
                    </div>
                </div>

                <!-- Content Grid -->
                <div class="content-grid">
                    <!-- Main Panel -->
                    <div class="main-panel">
                        <!-- Atividade Recente -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Atividade Recente</h2>
                            </div>
                            <div class="card-content">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Data</th>
                                                <th>Atividade</th>
                                                <th>Status</th>
                                                <th>Especialista</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Hoje</td>
                                                <td>Sessão de Fonoaudiologia</td>
                                                <td><span class="badge success">Concluída</span></td>
                                                <td>Dra. Ana Costa</td>
                                            </tr>
                                            <tr>
                                                <td>Ontem</td>
                                                <td>Atividade Cognitiva</td>
                                                <td><span class="badge success">Concluída</span></td>
                                                <td>Sistema</td>
                                            </tr>
                                            <tr>
                                                <td>15/11</td>
                                                <td>Consulta Psicológica</td>
                                                <td><span class="badge warning">Agendada</span></td>
                                                <td>Dr. Carlos Lima</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Ações Rápidas -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Ações Rápidas</h2>
                            </div>
                            <div class="card-content">
                                <div class="btn-group">
                                    <button class="btn btn-primary">
                                        <i class="fas fa-calendar-plus"></i>
                                        Agendar Consulta
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-file-medical"></i>
                                        Gerar Relatório
                                    </button>
                                    <button class="btn btn-secondary">
                                        <i class="fas fa-comments"></i>
                                        Conversar com Luna
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Side Panel -->
                    <div class="side-panel">
                        <!-- Próximas Consultas -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Próximas Consultas</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md); border-left: 3px solid var(--primary-blue);">
                                        <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.25rem;">Fonoaudiologia</div>
                                        <div style="font-size: var(--text-xs); color: var(--text-medium);">15/11 às 14:00</div>
                                    </div>
                                    <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md); border-left: 3px solid var(--primary-green);">
                                        <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.25rem;">Psicologia</div>
                                        <div style="font-size: var(--text-xs); color: var(--text-medium);">18/11 às 10:00</div>
                                    </div>
                                    <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md); border-left: 3px solid var(--primary-orange);">
                                        <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.25rem;">Neuropediatria</div>
                                        <div style="font-size: var(--text-xs); color: var(--text-medium);">20/11 às 16:00</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Status do Sistema -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Status do Sistema</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: rgba(84, 199, 164, 0.1); border-radius: var(--radius-md);">
                                    <i class="fas fa-check-circle" style="color: var(--primary-green); font-size: 1.25rem;"></i>
                                    <div>
                                        <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Todos os sistemas operacionais</div>
                                        <div style="font-size: var(--text-xs); color: var(--text-medium);">Última verificação: Agora</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

<!-- SUBSTITUIR a seção atual de perfil-autista1 por esta versão melhorada -->

<!-- SEÇÃO PERFIL DO AUTISTA -->
<section id="perfil-autista1" class="section">
    <div class="page-header">
        <div>
            <h1 class="page-title">Perfil do Autista</h1>
            <p class="page-subtitle">Informações e configurações do perfil</p>
        </div>
        <a href="../html/cadastroneuro.html" class="btn btn-primary">
            <i class="fas fa-user-plus"></i>
            Adicionar Neurodivergente
        </a>
    </div>

    <!-- Loading Spinner -->
    <div id="loading-neurodivergentes" style="display: none; text-align: center; padding: 40px;">
        <i class="fas fa-spinner fa-spin" style="font-size: 48px; color: #667eea;"></i>
        <p style="margin-top: 20px; color: #666;">Carregando informações...</p>
    </div>

    <!-- Container de Conteúdo -->
    <div id="container-neurodivergentes">
        <!-- Seletor de Neurodivergentes (aparece quando há mais de um) -->
        <div id="seletor-neurodivergentes" style="display: none; margin-bottom: 20px;">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-users"></i>
                        Selecionar Perfil
                    </h2>
                </div>
                <div class="card-content">
                    <select id="select-neurodivergente" class="form-input" style="padding: 12px; font-size: 16px; cursor: pointer;">
                        <!-- Opções serão preenchidas via JavaScript -->
                    </select>
                </div>
            </div>
        </div>

        <div class="content-grid">
            <!-- Painel Principal -->
            <div class="main-panel">
                <!-- Informações Pessoais -->
                <div class="card">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h2 class="card-title">Informações Pessoais</h2>
                        <div class="btn-group" id="botoes-acao-neurodivergente" style="display: none;">
                            <button class="btn btn-sm btn-primary" onclick="editarNeurodivergenteSelecionado()">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="excluirNeurodivergenteSelecionado()" style="color: #ef4444; border-color: #ef4444;">
                                <i class="fas fa-trash"></i> Excluir
                            </button>
                        </div>
                    </div>
                    <div class="card-content" id="info-pessoais-content">
                        <!-- Conteúdo será preenchido via JavaScript -->
                        <div style="text-align: center; padding: 60px 20px; color: #666;">
                            <i class="fas fa-user-plus" style="font-size: 64px; margin-bottom: 20px; color: #667eea; opacity: 0.3;"></i>
                            <p style="font-size: 18px; margin-bottom: 10px; font-weight: 500;">Nenhum neurodivergente cadastrado</p>
                            <p style="font-size: 14px; color: #999; margin-bottom: 20px;">Clique em "Adicionar Neurodivergente" para cadastrar</p>
                            <a href="../html/cadastroneuro.html" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Cadastrar Agora
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Endereço -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Endereço</h2>
                    </div>
                    <div class="card-content" id="endereco-content">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.25rem;">
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label class="form-label">Rua</label>
                                <input type="text" class="form-input" id="neuro-rua" disabled>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Número</label>
                                <input type="text" class="form-input" id="neuro-numero" disabled>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Complemento</label>
                                <input type="text" class="form-input" id="neuro-complemento" disabled>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Bairro</label>
                                <input type="text" class="form-input" id="neuro-bairro" disabled>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cidade</label>
                                <input type="text" class="form-input" id="neuro-cidade" disabled>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CEP</label>
                                <input type="text" class="form-input" id="neuro-cep" disabled>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Painel Lateral -->
            <div class="side-panel">
                <!-- Foto do Perfil -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Foto do Perfil</h2>
                    </div>
                    <div class="card-content">
                        <div style="text-align: center;">
                            <div id="neuro-avatar-display" style="width: 120px; height: 120px; margin: 0 auto 1rem; background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%); color: white; border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: var(--weight-semibold);">
                                <span id="neuro-iniciais">?</span>
                            </div>
                            <p style="font-size: var(--text-sm); color: var(--text-medium); font-weight: var(--weight-medium);" id="neuro-nome-display">Selecione um perfil</p>
                        </div>
                    </div>
                </div>

                <!-- Equipe Médica -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Equipe Médica</h2>
                    </div>
                    <div class="card-content">
                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md); display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 40px; height: 40px; background: rgba(74, 144, 226, 0.1); color: var(--primary-blue); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Dr. Pedro Oliveira</div>
                                    <div style="font-size: var(--text-xs); color: var(--text-medium);">Neuropediatra</div>
                                </div>
                            </div>
                            <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md); display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 40px; height: 40px; background: rgba(84, 199, 164, 0.1); color: var(--primary-green); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Dra. Ana Costa</div>
                                    <div style="font-size: var(--text-xs); color: var(--text-medium);">Fonoaudióloga</div>
                                </div>
                            </div>
                            <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md); display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 40px; height: 40px; background: rgba(255, 107, 53, 0.1); color: var(--primary-orange); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Dr. Carlos Lima</div>
                                    <div style="font-size: var(--text-xs); color: var(--text-medium);">Psicólogo</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contatos de Emergência -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Contatos de Emergência</h2>
                    </div>
                    <div class="card-content">
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <div>
                                <div style="font-size: var(--text-xs); font-weight: var(--weight-semibold); text-transform: uppercase; color: var(--text-medium); margin-bottom: 0.5rem;">Responsável Principal</div>
                                <div style="padding: 0.75rem; background: var(--bg-elevated); border-radius: var(--radius-md);">
                                    <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.25rem;" id="nome-responsavel">Carregando...</div>
                                    <div style="font-size: var(--text-sm); color: var(--text-medium); display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-phone" style="color: var(--primary-blue);"></i>
                                        <span id="celular-responsavel">Carregando...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Modal de Edição de Neurodivergente -->
<div class="modal fade" id="modalEditarNeuro" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h5 class="modal-title">
                    <i class="fas fa-user-edit"></i> Editar Perfil do Neurodivergente
                </h5>
                <button type="button" class="close" data-dismiss="modal" style="color: white; opacity: 1;">
                    <span>&times;</span>
                </button>
            </div>
            
            <form id="formEditarNeuro" onsubmit="salvarEdicaoNeurodivergente(event)">
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <input type="hidden" id="edit_id_neuro" name="id_neuro">
                    
                    <!-- Informações Pessoais -->
                    <div class="form-section">
                        <h6 class="section-title">
                            <i class="fas fa-user"></i> Informações Pessoais
                        </h6>
                        
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="edit_nome">Nome Completo *</label>
                                    <input type="text" class="form-control" id="edit_nome" name="nome" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_email">Email *</label>
                                    <input type="email" class="form-control" id="edit_email" name="email" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_data_nascimento">Data de Nascimento *</label>
                                    <input type="text" class="form-control" id="edit_data_nascimento" name="data_nascimento" 
                                           placeholder="DD/MM/AAAA" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="edit_rg">RG *</label>
                                    <input type="text" class="form-control" id="edit_rg" name="rg" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="edit_cpf">CPF *</label>
                                    <input type="text" class="form-control" id="edit_cpf" name="cpf" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="edit_sexo">Sexo *</label>
                                    <select class="form-control" id="edit_sexo" name="sexo" required>
                                        <option value="">Selecione</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Feminino">Feminino</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_celular">Celular</label>
                                    <input type="text" class="form-control" id="edit_celular" name="celular" 
                                           placeholder="(11) 99999-9999">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Endereço -->
                    <div class="form-section">
                        <h6 class="section-title">
                            <i class="fas fa-map-marker-alt"></i> Endereço
                        </h6>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="edit_cep">CEP *</label>
                                    <input type="text" class="form-control" id="edit_cep" name="cep" 
                                           placeholder="12345-678" required>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="form-group">
                                    <label for="edit_rua">Rua *</label>
                                    <input type="text" class="form-control" id="edit_rua" name="rua" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="edit_numero">Número *</label>
                                    <input type="text" class="form-control" id="edit_numero" name="numero" required>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label for="edit_complemento">Complemento</label>
                                    <input type="text" class="form-control" id="edit_complemento" name="complemento">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="edit_bairro">Bairro *</label>
                                    <input type="text" class="form-control" id="edit_bairro" name="bairro" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="edit_cidade">Cidade *</label>
                                    <input type="text" class="form-control" id="edit_cidade" name="cidade" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <i class="fas fa-info-circle"></i> Os campos marcados com * são obrigatórios.
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Salvar Alterações
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
/* Estilos para o Modal de Edição */
#modalEditarNeuro .modal-content {
    border-radius: 15px;
    border: none;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}

#modalEditarNeuro .modal-header {
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
    border-bottom: none;
    padding: 20px 30px;
}

#modalEditarNeuro .modal-body {
    padding: 30px;
}

#modalEditarNeuro .form-section {
    margin-bottom: 30px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
}

#modalEditarNeuro .section-title {
    color: #667eea;
    font-weight: 600;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #667eea;
}

#modalEditarNeuro .form-group label {
    font-weight: 500;
    color: #333;
    margin-bottom: 8px;
}

#modalEditarNeuro .form-control {
    border-radius: 8px;
    border: 2px solid #e0e0e0;
    padding: 10px 15px;
    transition: all 0.3s ease;
}

#modalEditarNeuro .form-control:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
}

#modalEditarNeuro .modal-footer {
    border-top: 1px solid #e0e0e0;
    padding: 20px 30px;
}

#modalEditarNeuro .btn {
    border-radius: 8px;
    padding: 10px 25px;
    font-weight: 500;
}

#modalEditarNeuro .btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
}

#modalEditarNeuro .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

/* Loading Spinner Animation */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.fa-spinner.fa-spin {
    animation: spin 1s linear infinite;
}

/* Responsividade */
@media (max-width: 768px) {
    #modalEditarNeuro .modal-dialog {
        margin: 10px;
    }
    
    #modalEditarNeuro .modal-body {
        padding: 20px 15px;
    }
    
    #modalEditarNeuro .form-section {
        padding: 15px;
    }
}
</style>

            <!-- Perfil Section -->
            <section id="perfil" class="section">
                <div class="page-header">
                    <h1 class="page-title">Meu Perfil</h1>
                    <p class="page-subtitle">Gerencie suas informações pessoais e preferências</p>
                </div>

                <div class="content-grid">
                    <div class="main-panel">
                        <!-- Informações Pessoais -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Informações Pessoais</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.25rem;">
                                    <div class="form-group">
                                        <label class="form-label">Nome Completo</label>
                                        <input type="text" class="form-input" id="perfil-nome" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-input" id="perfil-email" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Celular</label>
                                        <input type="tel" class="form-input" id="perfil-celular" placeholder="(11) 99999-9999" maxlength="15">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CPF</label>
                                        <input type="text" class="form-input" id="perfil-cpf" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Data de Nascimento</label>
                                        <input type="text" class="form-input" id="perfil-data-nascimento" disabled title="Este campo não pode ser alterado">
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer">
                                <button class="btn btn-secondary" onclick="cancelarEdicao()">Cancelar</button>
                                <button class="btn btn-primary" onclick="salvarAlteracoes()">Salvar Alterações</button>
                            </div>
                        </div>

                        <!-- Endereço -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Endereço</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.25rem;">
                                    <div class="form-group" style="grid-column: 1 / -1;">
                                        <label class="form-label">Rua</label>
                                        <input type="text" class="form-input" id="perfil-rua" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Número</label>
                                        <input type="text" class="form-input" id="perfil-numero" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Complemento</label>
                                        <input type="text" class="form-input" id="perfil-complemento" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Bairro</label>
                                        <input type="text" class="form-input" id="perfil-bairro" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cidade</label>
                                        <input type="text" class="form-input" id="perfil-cidade" disabled title="Este campo não pode ser alterado">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEP</label>
                                        <input type="text" class="form-input" id="perfil-cep" disabled title="Este campo não pode ser alterado">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Segurança -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Segurança</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: flex; flex-direction: column; gap: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: var(--radius-md);">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Autenticação de Dois Fatores</div>
                                            <div style="font-size: var(--text-xs); color: var(--text-medium); margin-top: 0.25rem;">Adicione uma camada extra de segurança</div>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <button class="btn btn-outline" style="width: fit-content;">
                                        <i class="fas fa-key"></i>
                                        Alterar Senha
                                    </button>
                                </div>

                                <h3 style="margin-top: 1.5rem; margin-bottom: 0.75rem; font-size: var(--text-base); font-weight: var(--weight-semibold);">Sessões Ativas</h3>
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Dispositivo</th>
                                                <th>Local</th>
                                                <th>Data</th>
                                                <th>Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><i class="fas fa-laptop"></i> Chrome - Windows</td>
                                                <td>São Paulo, BR</td>
                                                <td>Agora</td>
                                                <td><span class="badge primary">Atual</span></td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-mobile-alt"></i> Safari - iOS</td>
                                                <td>São Paulo, BR</td>
                                                <td>2 horas atrás</td>
                                                <td><button class="btn btn-sm btn-outline">Encerrar</button></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="side-panel">
                        <!-- Foto do Perfil -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Foto do Perfil</h2>
                            </div>
                            <div class="card-content">
                                <div style="text-align: center;">
                                    <div id="perfil-avatar-display" style="width: 120px; height: 120px; margin: 0 auto 1rem; background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%); color: white; border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: var(--weight-semibold); position: relative; overflow: hidden;">
                                        <span id="perfil-iniciais">M</span>
                                        <img id="perfil-foto-img" style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; display: none;">
                                    </div>
                                    <input type="file" id="input-foto-perfil" accept="image/*" style="display: none;">
                                    <button class="btn btn-outline btn-sm" onclick="document.getElementById('input-foto-perfil').click()">
                                        <i class="fas fa-camera"></i>
                                        Alterar Foto
                                    </button>
                                    <p style="margin-top: 0.5rem; font-size: var(--text-xs); color: var(--text-light);">Tamanho máximo: 5MB</p>
                                </div>
                            </div>
                        </div>

                        <!-- Estatísticas da Conta -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Estatísticas da Conta</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid var(--border-light);">
                                        <span style="font-size: var(--text-sm); color: var(--text-medium);">Membro desde</span>
                                        <span style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Janeiro 2024</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid var(--border-light);">
                                        <span style="font-size: var(--text-sm); color: var(--text-medium);">Sessões totais</span>
                                        <span style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">42</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0;">
                                        <span style="font-size: var(--text-sm); color: var(--text-medium);">Último acesso</span>
                                        <span style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark);">Hoje</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Preferências -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Preferências</h2>
                            </div>
                            <div class="card-content">
                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: var(--text-sm); font-weight: var(--weight-medium); color: var(--text-dark);">Notificações por Email</div>
                                            <div style="font-size: var(--text-xs); color: var(--text-medium); margin-top: 0.25rem;">Receba atualizações por email</div>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: var(--text-sm); font-weight: var(--weight-medium); color: var(--text-dark);">Notificações Push</div>
                                            <div style="font-size: var(--text-xs); color: var(--text-medium); margin-top: 0.25rem;">Receba alertas no navegador</div>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: var(--text-sm); font-weight: var(--weight-medium); color: var(--text-dark);">Lembrete de Consultas</div>
                                            <div style="font-size: var(--text-xs); color: var(--text-medium); margin-top: 0.25rem;">Alertas antes das consultas</div>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Luna Section -->
            <section id="luna" class="section">
                <div class="page-header">
                    <h1 class="page-title">Assistente Luna</h1>
                    <p class="page-subtitle">IA especializada em Transtorno do Espectro Autista</p>
                </div>

                <div class="card" style="max-width: 900px; margin: 0 auto;">
                    <div class="card-content" style="min-height: 500px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 3rem;">
                        <div style="width: 120px; height: 120px; background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%); color: white; border-radius: var(--radius-2xl); display: flex; align-items: center; justify-content: center; font-size: 4rem; margin-bottom: 2rem; box-shadow: var(--shadow-xl);">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 style="font-size: var(--text-2xl); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 1rem;">Olá! Sou a Luna</h3>
                        <p style="font-size: var(--text-base); color: var(--text-medium); max-width: 500px; margin-bottom: 2rem;">Estou aqui para ajudar você com informações sobre o desenvolvimento, tirar dúvidas sobre TEA e oferecer orientações personalizadas.</p>
                        <button class="btn btn-primary btn-lg" onclick="window.location.href='../html/luna.html'">
                            <i class="fas fa-comments"></i>
                            Iniciar Conversa
                        </button>
                    </div>
                </div>
            </section>

            <!-- Perfil Sensorial Section -->
            <section class="section" id="perfil-autista">
                <div class="page-header-simple">
                    <h1 class="page-title-simple">Perfil Sensorial</h1>
                    <button class="btn btn-outline-primary" onclick="shareProfile()">
                        <i class="fas fa-share-alt"></i> Compartilhar Perfil
                    </button>
                </div>

                <!-- INTERESSES E PREFERÊNCIAS -->
                <div class="card-modern">
                    <h2 class="section-title">Interesses e Preferências</h2>
                    
                    <div class="two-column-grid">
                        <!-- Coluna 1: Interesses Especiais -->
                        <div class="column-content">
                            <h3 class="subsection-title">Interesses Especiais</h3>
                            <div class="tags-container" id="interesses-container">
                                <span class="tag tag-blue">Dinossauros</span>
                                <span class="tag tag-blue">Trens</span>
                                <span class="tag tag-blue">Blocos de Montar</span>
                                <span class="tag tag-blue">Música</span>
                            </div>
                            <button class="btn-add" onclick="addItem('interesses')">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>

                        <!-- Coluna 2: Alimentos Preferidos -->
                        <div class="column-content">
                            <h3 class="subsection-title">Alimentos Preferidos</h3>
                            <div class="checklist-container" id="alimentos-container">
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Macarrão com molho de tomate</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('alimentos', 1)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('alimentos', 1)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Frango grelhado</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('alimentos', 2)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('alimentos', 2)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Banana</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('alimentos', 3)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('alimentos', 3)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Iogurte natural</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('alimentos', 4)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('alimentos', 4)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button class="btn-add" onclick="addItem('alimentos')">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- PERFIL SENSORIAL -->
                <div class="card-modern">
                    <h2 class="section-title">Perfil Sensorial</h2>
                    
                    <div class="two-column-grid">
                        <!-- Coluna 1: Sensibilidades -->
                        <div class="column-content">
                            <h3 class="subsection-title">Sensibilidades</h3>
                            <div class="tags-container" id="sensibilidades-container">
                                <span class="tag tag-orange">Sons Altos</span>
                                <span class="tag tag-orange">Luzes Fortes</span>
                                <span class="tag tag-orange">Multidões</span>
                            </div>
                            <button class="btn-add" onclick="addItem('sensibilidades')">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>

                        <!-- Coluna 2: Estratégias de Regulação -->
                        <div class="column-content">
                            <h3 class="subsection-title">Estratégias de Regulação</h3>
                            <div class="checklist-container" id="estrategias-container">
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Uso de fones com cancelamento de ruído</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('estrategias', 1)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('estrategias', 1)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Pausas em ambiente calmo</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('estrategias', 2)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('estrategias', 2)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Objeto de conforto (dinossauro de pelúcia)</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('estrategias', 3)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('estrategias', 3)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check check-icon"></i>
                                    <span>Respiração profunda</span>
                                    <div class="item-actions-inline">
                                        <button class="btn-icon-inline edit" onclick="editItemInline('estrategias', 4)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-icon-inline delete" onclick="deleteItemInline('estrategias', 4)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button class="btn-add" onclick="addItem('estrategias')">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- MARCOS DE DESENVOLVIMENTO -->
                <div class="card-modern">
                    <h2 class="section-title">Marcos de Desenvolvimento</h2>
                    
                    <div class="development-grid">
                        <div class="development-card">
                            <div class="development-header">
                                <div class="development-icon communication-icon">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <h3 class="development-title">COMUNICAÇÃO</h3>
                            </div>
                            <p class="development-text">Usa frases de 3-4 palavras</p>
                            <div class="development-actions">
                                <button class="btn-icon-inline edit" onclick="editDevelopment('comunicacao')">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </div>

                        <div class="development-card">
                            <div class="development-header">
                                <div class="development-icon social-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h3 class="development-title">SOCIAL</h3>
                            </div>
                            <p class="development-text">Iniciando contato visual</p>
                            <div class="development-actions">
                                <button class="btn-icon-inline edit" onclick="editDevelopment('social')">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </div>

                        <div class="development-card">
                            <div class="development-header">
                                <div class="development-icon selfcare-icon">
                                    <i class="fas fa-hand-sparkles"></i>
                                </div>
                                <h3 class="development-title">AUTOCUIDADO</h3>
                            </div>
                            <p class="development-text">Rotina de higiene básica</p>
                            <div class="development-actions">
                                <button class="btn-icon-inline edit" onclick="editDevelopment('autocuidado')">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </div>

                        <div class="development-card">
                            <div class="development-header">
                                <div class="development-icon motor-icon">
                                    <i class="fas fa-running"></i>
                                </div>
                                <h3 class="development-title">MOTOR</h3>
                            </div>
                            <p class="development-text">Coordenação motora fina</p>
                            <div class="development-actions">
                                <button class="btn-icon-inline edit" onclick="editDevelopment('motor')">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Progresso Section -->
            <section id="progresso" class="section">
                <div class="page-header">
                    <h1 class="page-title">Progresso</h1>
                    <p class="page-subtitle">Acompanhamento detalhado do desenvolvimento</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Relatórios de Progresso</h2>
                    </div>
                    <div class="card-content" style="min-height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;">
                        <div style="width: 80px; height: 80px; background: rgba(74, 144, 226, 0.1); color: var(--primary-blue); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin-bottom: 1.5rem;">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3 style="font-size: var(--text-xl); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.75rem;">Esta seção estará disponível em breve.</h3>
                        <p style="font-size: var(--text-base); color: var(--text-medium); max-width: 500px;">Aqui você poderá acompanhar gráficos detalhados, estatísticas e análises do desenvolvimento.</p>
                    </div>
                </div>
            </section>

            <!-- Especialistas Section -->
            <section id="especialistas" class="section">
                <div class="page-header">
                    <h1 class="page-title">Especialistas</h1>
                    <p class="page-subtitle">Gerencie sua equipe multidisciplinar</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Equipe Médica</h2>
                        <button class="btn btn-primary btn-sm" onclick="window.location.href='../html/especialista.html'">
                            <i class="fas fa-plus"></i>
                            Adicionar Especialista
                        </button>
                    </div>
                    <div class="card-content">
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Especialista</th>
                                        <th>Especialidade</th>
                                        <th>Contato</th>
                                        <th>Próxima Consulta</th>
                                        <th>Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Dr. Pedro Oliveira</td>
                                        <td>Neuropediatra</td>
                                        <td>(11) 91234-5678</td>
                                        <td>20/11/2024</td>
                                        <td><span class="badge success">Ativo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline">Editar</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Dra. Ana Costa</td>
                                        <td>Fonoaudióloga</td>
                                        <td>(11) 92345-6789</td>
                                        <td>15/11/2024</td>
                                        <td><span class="badge success">Ativo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline">Editar</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Dr. Carlos Lima</td>
                                        <td>Psicólogo</td>
                                        <td>(11) 93456-7890</td>
                                        <td>18/11/2024</td>
                                        <td><span class="badge success">Ativo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline">Editar</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <h2 class="card-title">Calendário de Consultas</h2>
                    </div>
                    <div class="card-content">
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Data</th>
                                        <th>Horário</th>
                                        <th>Especialista</th>
                                        <th>Tipo</th>
                                        <th>Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>15/11/2024</td>
                                        <td>14:00</td>
                                        <td>Dra. Ana Costa</td>
                                        <td>Fonoaudiologia</td>
                                        <td><span class="badge warning">Agendada</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline">Detalhes</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>18/11/2024</td>
                                        <td>10:00</td>
                                        <td>Dr. Carlos Lima</td>
                                        <td>Psicologia</td>
                                        <td><span class="badge warning">Agendada</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline">Detalhes</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>20/11/2024</td>
                                        <td>16:00</td>
                                        <td>Dra. Fernanda Santos</td>
                                        <td>Terapia Ocupacional</td>
                                        <td><span class="badge warning">Agendada</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline">Detalhes</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Relatórios Section -->
            <section id="relatorios" class="section">
                <div class="page-header">
                    <h1 class="page-title">Relatórios</h1>
                    <p class="page-subtitle">Relatórios detalhados de acompanhamento</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Sistema de Relatórios</h2>
                    </div>
                    <div class="card-content" style="min-height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;">
                        <div style="width: 80px; height: 80px; background: rgba(74, 144, 226, 0.1); color: var(--primary-blue); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin-bottom: 1.5rem;">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <h3 style="font-size: var(--text-xl); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.75rem;">Esta funcionalidade estará disponível em breve.</h3>
                        <p style="font-size: var(--text-base); color: var(--text-medium); max-width: 500px;">Aqui você poderá gerar relatórios personalizados sobre o desenvolvimento, atividades e marcos alcançados.</p>
                    </div>
                </div>
            </section>

            <!-- Recursos Section -->
            <section id="recursos" class="section">
                <div class="page-header">
                    <h1 class="page-title">Recursos & Suporte</h1>
                    <p class="page-subtitle">Materiais educativos, vídeos informativos e canais de comunicação</p>
                </div>

                <!-- Materiais PDF -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Materiais em PDF</h2>
                    </div>
                    <div class="card-content">
                        <p style="margin-bottom: 1.5rem; color: var(--text-medium);">Acesse cartilhas, guias e materiais educativos sobre o Transtorno do Espectro Autista.</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;">
                            <a href="https://www.defensoria.rs.def.br/upload/arquivos/202504/25112005-cartilha-crianca-e-adolescente-com-autismo-2025.pdf" target="_blank" style="text-decoration: none; padding: 1rem; background: var(--bg-elevated); border-radius: var(--radius-md); border: 1px solid var(--border-light); transition: all var(--transition-base); display: block;">
                                <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                                    <div style="width: 40px; height: 40px; background: rgba(255, 107, 53, 0.1); color: var(--primary-orange); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                        <i class="fas fa-file-pdf"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="font-size: var(--text-sm); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.25rem;">Direitos da Criança e Adolescente com Autismo</h3>
                                        <p style="font-size: var(--text-xs); color: var(--text-medium); margin-bottom: 0.5rem;">Cartilha completa sobre direitos, características do TEA e orientações para famílias (2025)</p>
                                        <span style="font-size: var(--text-xs); color: var(--primary-blue); font-weight: var(--weight-medium);">Defensoria Pública RS</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Configurações Section -->
            <section id="configuracoes" class="section">
                <div class="page-header">
                    <h1 class="page-title">Configurações</h1>
                    <p class="page-subtitle">Personalize sua experiência na plataforma</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Configurações do Sistema</h2>
                    </div>
                    <div class="card-content" style="min-height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;">
                        <div style="width: 80px; height: 80px; background: rgba(74, 144, 226, 0.1); color: var(--primary-blue); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin-bottom: 1.5rem;">
                            <i class="fas fa-cog"></i>
                        </div>
                        <h3 style="font-size: var(--text-xl); font-weight: var(--weight-semibold); color: var(--text-dark); margin-bottom: 0.75rem;">Configurações em desenvolvimento</h3>
                        <p style="font-size: var(--text-base); color: var(--text-medium); max-width: 500px;">Em breve você poderá personalizar temas, idiomas, notificações e muito mais.</p>
                    </div>
                </div>
            </section>

        </main>
    </div>

<script>
// ============================================
// VARIÁVEIS GLOBAIS
// ============================================
let neurodivergentesCache = [];
let neurodivergenteSelecionadoIndex = 0;
let currentStep = 1;
const totalSteps = 5;

// ============================================
// TUTORIAL - FUNÇÕES
// ============================================
function nextStep() {
    if (currentStep < totalSteps) {
        document.querySelector(`.tutorial-step[data-step="${currentStep}"]`).classList.remove('active');
        currentStep++;
        document.querySelector(`.tutorial-step[data-step="${currentStep}"]`).classList.add('active');
        updateProgress();
    }
}

function prevStep() {
    if (currentStep > 1) {
        document.querySelector(`.tutorial-step[data-step="${currentStep}"]`).classList.remove('active');
        currentStep--;
        document.querySelector(`.tutorial-step[data-step="${currentStep}"]`).classList.add('active');
        updateProgress();
    }
}

function updateProgress() {
    const progress = (currentStep / totalSteps) * 100;
    document.getElementById('tutorial-progress').style.width = progress + '%';
    document.getElementById('step-counter').textContent = `${currentStep} / ${totalSteps}`;
}

function toggleFinishButton() {
    const checkbox = document.getElementById('terms-checkbox');
    const finishBtn = document.getElementById('finish-btn');
    finishBtn.disabled = !checkbox.checked;
}

function closeTutorial() {
    const checkbox = document.getElementById('terms-checkbox');
    if (!checkbox.checked) {
        alert('Por favor, aceite os Termos de Uso e a Política de Privacidade para continuar.');
        return;
    }
    
    const overlay = document.getElementById('tutorial-overlay');
    overlay.classList.remove('active');
    
    // Salvar no localStorage que o tutorial foi concluído
    localStorage.setItem('tutorialCompleto', 'true');
}

// ============================================
// NAVEGAÇÃO ENTRE SEÇÕES
// ============================================
document.addEventListener('DOMContentLoaded', function() {
    // Verificar se o tutorial já foi concluído
    if (localStorage.getItem('tutorialCompleto') === 'true') {
        document.getElementById('tutorial-overlay').classList.remove('active');
    }
    
    // Navegação do menu
    const navItems = document.querySelectorAll('.nav-item');
    const sections = document.querySelectorAll('.section');

    navItems.forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Remove active de todos os itens e seções
            navItems.forEach(nav => nav.classList.remove('active'));
            sections.forEach(section => section.classList.remove('active'));
            
            // Adiciona active ao item clicado
            this.classList.add('active');
            
            // Mostra a seção correspondente
            const sectionId = this.getAttribute('data-section');
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                
                // Se for a seção de perfil do autista, carregar dados
                if (sectionId === 'perfil-autista1') {
                    carregarNeurodivergentes();
                }
                
                // Se for a seção de perfil do responsável, carregar dados
                if (sectionId === 'perfil') {
                    carregarDadosPerfil();
                }
            }
        });
    });
    
    // Inicializações
    verificarSessao();
    carregarDadosPerfil();
    
    // Aplicar máscara ao celular
    $('#perfil-celular').mask('(00) 00000-0000');
});

// ============================================
// VERIFICAR SESSÃO E CARREGAR DADOS DO HEADER
// ============================================
function verificarSessao() {
    fetch('../php/verificar_sessao_responsavel.php')
        .then(response => response.json())
        .then(data => {
            console.log('Verificação de sessão:', data);
            
            if (!data.logado) {
                alert('Sessão expirada. Faça login novamente.');
                window.location.href = '../html/login.html';
                return;
            }
            
            if (data.success) {
                const dados = data.dados;
                
                // Atualizar nome no header
                const nomeHeader = document.getElementById('header-nome');
                if (nomeHeader) {
                    nomeHeader.textContent = dados.primeiro_nome;
                }
                
                // Atualizar iniciais/foto do avatar no header
                const avatarHeader = document.getElementById('header-avatar');
                if (avatarHeader) {
                    if (dados.perfil && dados.perfil.trim() !== '') {
                        avatarHeader.style.backgroundImage = `url('../${dados.perfil}')`;
                        avatarHeader.style.backgroundSize = 'cover';
                        avatarHeader.style.backgroundPosition = 'center';
                        avatarHeader.textContent = '';
                    } else {
                        avatarHeader.textContent = dados.iniciais;
                        avatarHeader.style.backgroundImage = 'none';
                    }
                }
                
                // Atualizar mensagem de boas-vindas no dashboard
                const boasVindas = document.getElementById('dashboard-boas-vindas');
                if (boasVindas) {
                    boasVindas.textContent = `Bem-vinda, ${dados.primeiro_nome}`;
                }
            }
        })
        .catch(error => {
            console.error('Erro ao verificar sessão:', error);
            alert('Erro ao verificar sessão. Redirecionando para login...');
            setTimeout(() => {
                window.location.href = '../html/login.html';
            }, 2000);
        });
}

// ============================================
// FUNÇÃO DE LOGOUT
// ============================================
function fazerLogout() {
    if (confirm('Deseja realmente sair do sistema?')) {
        window.location.href = '../php/logout_responsavel.php';
    }
}

// ============================================
// CARREGAR DADOS DO PERFIL DO RESPONSÁVEL
// ============================================
function carregarDadosPerfil() {
    fetch('../php/buscar_dados_responsavel.php')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const dados = data.dados;
                
                // Preencher campos pessoais
                document.getElementById('perfil-nome').value = dados.nome || '';
                document.getElementById('perfil-email').value = dados.email || '';
                document.getElementById('perfil-celular').value = dados.celular_formatado || '';
                document.getElementById('perfil-cpf').value = dados.cpf_formatado || '';
                document.getElementById('perfil-data-nascimento').value = dados.data_nascimento_formatada || '';
                
                // Preencher endereço
                document.getElementById('perfil-rua').value = dados.rua || '';
                document.getElementById('perfil-numero').value = dados.numero || '';
                document.getElementById('perfil-complemento').value = dados.complemento || '';
                document.getElementById('perfil-bairro').value = dados.bairro || '';
                document.getElementById('perfil-cidade').value = dados.cidade || '';
                document.getElementById('perfil-cep').value = dados.cep_formatado || '';
                
                // Atualizar foto/avatar
                const iniciais = dados.iniciais || 'M';
                const perfilIniciais = document.getElementById('perfil-iniciais');
                const perfilFotoImg = document.getElementById('perfil-foto-img');
                
                if (perfilIniciais) {
                    perfilIniciais.textContent = iniciais;
                }
                
                if (dados.perfil && dados.perfil.trim() !== '' && perfilFotoImg) {
                    perfilFotoImg.src = '../' + dados.perfil + '?t=' + new Date().getTime();
                    perfilFotoImg.style.display = 'block';
                    if (perfilIniciais) {
                        perfilIniciais.style.display = 'none';
                    }
                } else if (perfilFotoImg) {
                    perfilFotoImg.style.display = 'none';
                    if (perfilIniciais) {
                        perfilIniciais.style.display = 'flex';
                    }
                }
            } else {
                console.error('Erro ao carregar dados:', data.message);
                alert('Erro ao carregar dados do perfil: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Erro:', error);
            alert('Erro ao carregar dados do perfil. Verifique sua conexão.');
        });
}

// ============================================
// SALVAR ALTERAÇÕES (CELULAR)
// ============================================
function salvarAlteracoes() {
    const celular = document.getElementById('perfil-celular').value;
    
    if (!celular) {
        alert('Por favor, preencha o celular');
        return;
    }
    
    const celularLimpo = celular.replace(/\D/g, '');
    if (celularLimpo.length !== 11) {
        alert('Celular inválido! Digite no formato (11) 99999-9999');
        return;
    }
    
    const formData = new FormData();
    formData.append('celular', celular);
    
    const btnSalvar = event.target;
    const textoOriginal = btnSalvar.innerHTML;
    btnSalvar.disabled = true;
    btnSalvar.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Salvando...';
    
    fetch('../php/atualizar_perfil_responsavel.php', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
            carregarDadosPerfil();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        console.error('Erro:', error);
        alert('Erro ao salvar alterações. Tente novamente.');
    })
    .finally(() => {
        btnSalvar.disabled = false;
        btnSalvar.innerHTML = textoOriginal;
    });
}

// ============================================
// CANCELAR EDIÇÃO
// ============================================
function cancelarEdicao() {
    if (confirm('Deseja descartar as alterações?')) {
        carregarDadosPerfil();
    }
}

// ============================================
// UPLOAD DE FOTO
// ============================================
const inputFoto = document.getElementById('input-foto-perfil');
if (inputFoto) {
    inputFoto.addEventListener('change', function(e) {
        const file = e.target.files[0];
        
        if (!file) return;
        
        if (file.size > 5242880) {
            alert('Arquivo muito grande! Tamanho máximo: 5MB');
            inputFoto.value = '';
            return;
        }
        
        const tiposPermitidos = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];
        if (!tiposPermitidos.includes(file.type)) {
            alert('Tipo de arquivo inválido! Use apenas JPG, PNG ou GIF');
            inputFoto.value = '';
            return;
        }
        
        const formData = new FormData();
        formData.append('perfil', file);
        
        const avatarDisplay = document.getElementById('perfil-avatar-display');
        const originalContent = avatarDisplay.innerHTML;
        avatarDisplay.innerHTML = '<i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: white;"></i>';
        
        fetch('../php/atualizar_perfil_responsavel.php', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message);
                carregarDadosPerfil();
                verificarSessao();
            } else {
                alert(data.message);
                avatarDisplay.innerHTML = originalContent;
            }
        })
        .catch(error => {
            console.error('Erro:', error);
            alert('Erro ao fazer upload da foto. Tente novamente.');
            avatarDisplay.innerHTML = originalContent;
        });
    });
}

// ============================================
// CARREGAR DADOS DOS NEURODIVERGENTES
// ============================================
function carregarNeurodivergentes() {
    const loadingElement = document.getElementById('loading-neurodivergentes');
    const containerElement = document.getElementById('container-neurodivergentes');
    const infoPessoaisContent = document.getElementById('info-pessoais-content');
    
    // Mostrar loading
    if (loadingElement) loadingElement.style.display = 'block';
    if (containerElement) containerElement.style.display = 'none';
    
    fetch('../php/buscar_dados_neurodivergente.php')
        .then(response => response.json())
        .then(data => {
            console.log('Dados recebidos:', data);
            
            // Esconder loading
            if (loadingElement) loadingElement.style.display = 'none';
            if (containerElement) containerElement.style.display = 'block';
            
            if (data.success && data.dados && data.dados.length > 0) {
                neurodivergentesCache = data.dados;
                
                // Se há mais de um neurodivergente, mostrar seletor
                if (data.dados.length > 1) {
                    mostrarSeletorNeurodivergentes(data.dados);
                }
                
                // Exibir o primeiro (ou único) neurodivergente
                exibirDadosNeurodivergente(0);
                
            } else {
                // Nenhum neurodivergente cadastrado
                if (infoPessoaisContent) {
                    infoPessoaisContent.innerHTML = `
                        <div style="text-align: center; padding: 40px 20px; color: #666;">
                            <i class="fas fa-user-plus" style="font-size: 48px; margin-bottom: 20px; color: #00bfa5;"></i>
                            <p style="font-size: 18px; margin-bottom: 10px;">Nenhum neurodivergente cadastrado</p>
                            <p style="font-size: 14px; color: #999; margin-bottom: 20px;">Clique em "Adicionar Neurodivergente" para cadastrar</p>
                            <a href="../html/cadastroneuro.html" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Cadastrar Agora
                            </a>
                        </div>
                    `;
                }
                
                // Esconder botões de ação
                const botoesAcao = document.getElementById('botoes-acao-neurodivergente');
                if (botoesAcao) botoesAcao.style.display = 'none';
            }
        })
        .catch(error => {
            console.error('Erro ao carregar neurodivergentes:', error);
            if (loadingElement) loadingElement.style.display = 'none';
            if (containerElement) containerElement.style.display = 'block';
            
            if (infoPessoaisContent) {
                infoPessoaisContent.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #dc3545;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 20px;"></i>
                        <p style="font-size: 18px; margin-bottom: 10px;">Erro ao carregar dados</p>
                        <p style="font-size: 14px; color: #999;">Tente novamente mais tarde</p>
                    </div>
                `;
            }
        });
}

// ============================================
// MOSTRAR SELETOR DE NEURODIVERGENTES
// ============================================
function mostrarSeletorNeurodivergentes(neurodivergentes) {
    const seletor = document.getElementById('seletor-neurodivergentes');
    const selectElement = document.getElementById('select-neurodivergente');
    
    if (!seletor || !selectElement) return;
    
    // Limpar opções anteriores
    selectElement.innerHTML = '';
    
    // Adicionar opções
    neurodivergentes.forEach((neuro, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = neuro.nome;
        selectElement.appendChild(option);
    });
    
    // Mostrar seletor
    seletor.style.display = 'block';
    
    // Adicionar evento de mudança
    selectElement.addEventListener('change', function() {
        neurodivergenteSelecionadoIndex = parseInt(this.value);
        exibirDadosNeurodivergente(neurodivergenteSelecionadoIndex);
    });
}

// ============================================
// EXIBIR DADOS DO NEURODIVERGENTE
// ============================================
function exibirDadosNeurodivergente(index) {
    if (!neurodivergentesCache || neurodivergentesCache.length === 0) return;
    
    const neuro = neurodivergentesCache[index];
    const infoPessoaisContent = document.getElementById('info-pessoais-content');
    const botoesAcao = document.getElementById('botoes-acao-neurodivergente');
    
    // Mostrar botões de ação
    if (botoesAcao) {
        botoesAcao.style.display = 'flex';
        botoesAcao.style.gap = '0.5rem';
    }
    
    // Preencher informações pessoais - LAYOUT IGUAL AO MEU PERFIL
    if (infoPessoaisContent) {
        infoPessoaisContent.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.25rem;">
                <div class="form-group">
                    <label class="form-label">Nome Completo</label>
                    <input type="text" class="form-input" value="${neuro.nome || ''}" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" value="${neuro.email || ''}" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Data de Nascimento</label>
                    <input type="text" class="form-input" value="${neuro.data_nascimento_formatada || ''}" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Idade</label>
                    <input type="text" class="form-input" value="${neuro.idade || 0} anos" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">RG</label>
                    <input type="text" class="form-input" value="${neuro.rg_formatado || ''}" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">CPF</label>
                    <input type="text" class="form-input" value="${neuro.cpf_formatado || ''}" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Sexo</label>
                    <input type="text" class="form-input" value="${neuro.sexo || ''}" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Celular</label>
                    <input type="text" class="form-input" value="${neuro.celular_formatado || 'Não informado'}" disabled>
                </div>
            </div>
        `;
    }
    
    // Preencher endereço
    const neuroRua = document.getElementById('neuro-rua');
    const neuroNumero = document.getElementById('neuro-numero');
    const neuroComplemento = document.getElementById('neuro-complemento');
    const neuroBairro = document.getElementById('neuro-bairro');
    const neuroCidade = document.getElementById('neuro-cidade');
    const neuroCep = document.getElementById('neuro-cep');
    
    if (neuroRua) neuroRua.value = neuro.rua || '';
    if (neuroNumero) neuroNumero.value = neuro.numero || '';
    if (neuroComplemento) neuroComplemento.value = neuro.complemento || '';
    if (neuroBairro) neuroBairro.value = neuro.bairro || '';
    if (neuroCidade) neuroCidade.value = neuro.cidade || '';
    if (neuroCep) neuroCep.value = neuro.cep_formatado || '';
    
    // Atualizar avatar e nome
    const neuroIniciais = document.getElementById('neuro-iniciais');
    const neuroNomeDisplay = document.getElementById('neuro-nome-display');
    
    if (neuroIniciais) {
        neuroIniciais.textContent = neuro.iniciais || '?';
    }
    if (neuroNomeDisplay) {
        neuroNomeDisplay.textContent = neuro.nome || 'Nome não disponível';
    }
    
    // Preencher contatos de emergência
    const nomeResponsavel = document.getElementById('nome-responsavel');
    const celularResponsavel = document.getElementById('celular-responsavel');
    
    if (nomeResponsavel) {
        nomeResponsavel.textContent = neuro.nome_responsavel || 'Não informado';
    }
    if (celularResponsavel) {
        celularResponsavel.textContent = neuro.celular_responsavel_formatado || 'Não informado';
    }
}

// ============================================
// EDITAR NEURODIVERGENTE SELECIONADO
// ============================================
function editarNeurodivergenteSelecionado() {
    if (!neurodivergentesCache || neurodivergentesCache.length === 0) {
        alert('Nenhum neurodivergente selecionado');
        return;
    }
    
    const neuro = neurodivergentesCache[neurodivergenteSelecionadoIndex];
    
    // Preencher o formulário do modal
    document.getElementById('edit_id_neuro').value = neuro.id;
    document.getElementById('edit_nome').value = neuro.nome || '';
    document.getElementById('edit_email').value = neuro.email || '';
    document.getElementById('edit_data_nascimento').value = neuro.data_nascimento_formatada || '';
    document.getElementById('edit_rg').value = neuro.rg || '';
    document.getElementById('edit_cpf').value = neuro.cpf || '';
    document.getElementById('edit_sexo').value = neuro.sexo || '';
    document.getElementById('edit_celular').value = neuro.celular_formatado || '';
    document.getElementById('edit_cep').value = neuro.cep_formatado || '';
    document.getElementById('edit_rua').value = neuro.rua || '';
    document.getElementById('edit_numero').value = neuro.numero || '';
    document.getElementById('edit_complemento').value = neuro.complemento || '';
    document.getElementById('edit_bairro').value = neuro.bairro || '';
    document.getElementById('edit_cidade').value = neuro.cidade || '';
    
    // Aplicar máscaras
    aplicarMascarasModal();
    
    // Abrir modal
    $('#modalEditarNeuro').modal('show');
}

// ============================================
// APLICAR MÁSCARAS NO MODAL
// ============================================
function aplicarMascarasModal() {
    $('#edit_data_nascimento').mask('00/00/0000');
    $('#edit_rg').mask('00.000.000-0');
    $('#edit_cpf').mask('000.000.000-00');
    $('#edit_celular').mask('(00) 00000-0000');
    $('#edit_cep').mask('00000-000');
}

// ============================================
// SALVAR EDIÇÃO DO NEURODIVERGENTE
// ============================================
function salvarEdicaoNeurodivergente(event) {
    event.preventDefault();
    
    const form = document.getElementById('formEditarNeuro');
    const formData = new FormData(form);
    
    const btnSubmit = form.querySelector('button[type="submit"]');
    const textoOriginal = btnSubmit.innerHTML;
    btnSubmit.disabled = true;
    btnSubmit.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Salvando...';
    
    fetch('../php/atualizar_perfil_neurodivergente.php', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
            $('#modalEditarNeuro').modal('hide');
            carregarNeurodivergentes();
        } else {
            alert('Erro: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Erro:', error);
        alert('Erro ao salvar alterações. Tente novamente.');
    })
    .finally(() => {
        btnSubmit.disabled = false;
        btnSubmit.innerHTML = textoOriginal;
    });
}

// ============================================
// EXCLUIR NEURODIVERGENTE SELECIONADO
// ============================================
function excluirNeurodivergenteSelecionado() {
    if (!neurodivergentesCache || neurodivergentesCache.length === 0) {
        alert('Nenhum neurodivergente selecionado');
        return;
    }
    
    const neuro = neurodivergentesCache[neurodivergenteSelecionadoIndex];
    
    if (!confirm(`Tem certeza que deseja excluir o perfil de ${neuro.nome}?\n\nEsta ação não pode ser desfeita!`)) {
        return;
    }
    
    const formData = new FormData();
    formData.append('id_neuro', neuro.id);
    
    fetch('../php/excluir_neurodivergente.php', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
            carregarNeurodivergentes();
        } else {
            alert('Erro: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Erro:', error);
        alert('Erro ao excluir perfil. Tente novamente.');
    });
}

// ============================================
// FUNÇÕES DO PERFIL SENSORIAL (PLACEHOLDER)
// ============================================
function shareProfile() {
    alert('Função de compartilhamento em desenvolvimento');
}

function addItem(tipo) {
    const texto = prompt(`Adicionar novo item em ${tipo}:`);
    if (texto && texto.trim() !== '') {
        alert(`Item "${texto}" adicionado! (Função em desenvolvimento)`);
    }
}

function editItemInline(tipo, id) {
    alert(`Editar item ${id} de ${tipo} (Função em desenvolvimento)`);
}

function deleteItemInline(tipo, id) {
    if (confirm('Deseja excluir este item?')) {
        alert(`Item ${id} de ${tipo} excluído! (Função em desenvolvimento)`);
    }
}

function editDevelopment(tipo) {
    alert(`Editar marco de desenvolvimento: ${tipo} (Função em desenvolvimento)`);
}
</script>

<style>
/* ============================================
   ESTILOS ADICIONAIS PARA INFO ITEMS
   ============================================ */
.info-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.info-label {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    color: #6c757d;
    letter-spacing: 0.5px;
}

.info-value {
    font-size: 1rem;
    font-weight: 500;
    color: #212529;
    margin: 0;
}

/* Estilos para o botão de adicionar neurodivergente */
.btn-adicionar-neuro {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(102, 126, 234, 0.25);
}

.btn-adicionar-neuro:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
    color: white;
    text-decoration: none;
}

/* Estilos para o seletor de neurodivergentes */
#seletor-neurodivergentes .form-control {
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 500;
    color: #333;
    transition: all 0.3s ease;
}

#seletor-neurodivergentes .form-control:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
}

/* Estilos para os botões de ação */
.btn-group {
    display: flex;
    gap: 0.5rem;
}

/* Loading spinner */
#loading-neurodivergentes {
    text-align: center;
    padding: 60px 20px;
}

#loading-neurodivergentes i {
    font-size: 48px;
    color: #667eea;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Estilos do Tutorial */
.tutorial-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.tutorial-overlay.active {
    display: flex;
}

.tutorial-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
}

.tutorial-content {
    position: relative;
    background: white;
    border-radius: 20px;
    max-width: 600px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.tutorial-progress {
    padding: 20px 30px;
    border-bottom: 1px solid #e0e0e0;
}

.tutorial-progress-bar {
    height: 8px;
    background: #e0e0e0;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}

.tutorial-progress-fill {
    height: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    transition: width 0.3s ease;
    width: 20%;
}

.tutorial-step-counter {
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

.tutorial-step {
    display: none;
    padding: 40px 30px;
}

.tutorial-step.active {
    display: block;
}

.tutorial-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 36px;
}

.tutorial-title {
    font-size: 28px;
    font-weight: 700;
    color: #333;
    text-align: center;
    margin-bottom: 15px;
}

.tutorial-description {
    font-size: 16px;
    color: #666;
    text-align: center;
    line-height: 1.6;
    margin-bottom: 30px;
}

.tutorial-info-box {
    background: #f0f4ff;
    border-left: 4px solid #667eea;
    padding: 15px;
    border-radius: 8px;
    display: flex;
    gap: 12px;
    align-items: flex-start;
    margin-bottom: 30px;
}

.tutorial-info-box i {
    color: #667eea;
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
}

.tutorial-info-box p {
    margin: 0;
    font-size: 14px;
    color: #555;
    line-height: 1.5;
}

.tutorial-features-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-bottom: 30px;
}

.tutorial-feature-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 10px;
    transition: all 0.3s ease;
}

.tutorial-feature-item:hover {
    background: #e9ecef;
    transform: translateX(5px);
}

.tutorial-feature-item i {
    font-size: 24px;
    color: #667eea;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    border-radius: 8px;
    flex-shrink: 0;
}

.tutorial-feature-item span {
    font-size: 14px;
    color: #555;
    line-height: 1.5;
}

.tutorial-terms {
    margin: 20px 0;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
}

.tutorial-checkbox-container {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    cursor: pointer;
    user-select: none;
}

.tutorial-checkbox-container input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
    flex-shrink: 0;
    margin-top: 2px;
}

.tutorial-checkbox-label {
    font-size: 14px;
    color: #555;
    line-height: 1.5;
}

.tutorial-link {
    color: #667eea;
    text-decoration: none;
    font-weight: 500;
}

.tutorial-link:hover {
    text-decoration: underline;
}

.tutorial-actions {
    display: flex;
    justify-content: space-between;
    gap: 15px;
    margin-top: 30px;
}

.tutorial-actions .btn {
    flex: 1;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: 500;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.3s ease;
}

.tutorial-actions .btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.tutorial-actions .btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.tutorial-actions .btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.tutorial-actions .btn-secondary {
    background: #6c757d;
    color: white;
}

.tutorial-actions .btn-secondary:hover {
    background: #5a6268;
}

/* Responsividade */
@media (max-width: 768px) {
    .tutorial-content {
        max-width: 100%;
        border-radius: 15px;
    }
    
    .tutorial-step {
        padding: 30px 20px;
    }
    
    .tutorial-title {
        font-size: 24px;
    }
    
    .tutorial-description {
        font-size: 14px;
    }
    
    .tutorial-actions {
        flex-direction: column;
    }
    
    .tutorial-actions .btn {
        width: 100%;
    }
}
</style>
