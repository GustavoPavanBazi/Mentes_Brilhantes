<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mentes Brilhantes</title>
  <link rel="stylesheet" href="../css/adm_especialista.css">
  <link rel="icon" type="image/x-icon" href="../img/LogoMB.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-container">
      <div class="logo-section">
        <img src="../img/LogoMB.png" alt="Mentes Brilhantes">
        <span>Mentes Brilhantes</span>
      </div>
      <div class="user-profile" onclick="toggleUserDropdown()">
        <div class="user-avatar">MF</div>
        <div class="user-info">
          <h4>Dra. Marina Fernandes</h4>
          <p>Especialista</p>
        </div>
        <i class="fas fa-chevron-down text-xs"></i>
        <div class="user-dropdown" id="userDropdown">
          <div class="user-dropdown-item" onclick="navigateTo('perfil')">
            <i class="fas fa-user"></i> Meu Perfil
          </div>
          <div class="user-dropdown-item" onclick="navigateTo('configuracoes')">
            <i class="fas fa-cog"></i> Configurações
          </div>
          <div class="user-dropdown-item" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> Sair
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Layout -->
  <div class="main-layout">
    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="nav-section">
        <div class="nav-title">Principal</div>
        <a class="nav-item active" data-section="dashboard">
          <i class="fas fa-chart-line"></i><span>Dashboard</span>
        </a>
        <a class="nav-item" data-section="consultas">
          <i class="fas fa-calendar-alt"></i><span>Consultas</span>
        </a>
        <a class="nav-item" data-section="pacientes">
          <i class="fas fa-users"></i><span>Pacientes</span>
        </a>
      </div>
      <div class="nav-section">
        <div class="nav-title">Gestão</div>
        <a class="nav-item" data-section="avaliacoes">
          <i class="fas fa-star"></i><span>Avaliações</span>
        </a>
        <a class="nav-item" data-section="conteudos">
          <i class="fas fa-book"></i><span>Conteúdos</span>
        </a>
        <a class="nav-item" data-section="agenda">
          <i class="fas fa-clock"></i><span>Agenda</span>
        </a>
      </div>
      <div class="nav-section">
        <div class="nav-title">Conta</div>
        <a class="nav-item" data-section="perfil">
          <i class="fas fa-user-cog"></i><span>Meu Perfil</span>
        </a>
        <a class="nav-item" data-section="configuracoes">
          <i class="fas fa-cog"></i><span>Configurações</span>
        </a>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard Section -->
      <div class="section active" id="dashboard">
        <div class="page-header">
          <h1 class="page-title">Bem-vinda, Dra. Marina</h1>
          <p class="page-subtitle">Aqui está um resumo das suas atividades recentes.</p>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon primary">
              <i class="fas fa-calendar-check"></i>
            </div>
            <div class="stat-value" id="totalConsultas">24</div>
            <div class="stat-label">Consultas do Mês</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon success">
              <i class="fas fa-users"></i>
            </div>
            <div class="stat-value" id="totalPacientes">127</div>
            <div class="stat-label">Pacientes Ativos</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon warning">
              <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="stat-value" id="receitaMensal">R$ 6.720</div>
            <div class="stat-label">Receita Mensal</div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Próximas Consultas</span>
            <button class="btn btn-primary btn-sm" onclick="navigateTo('consultas')">
              Ver Todas
            </button>
          </div>
          <div class="card-content">
            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>Paciente</th>
                    <th>Data/Hora</th>
                    <th>Tipo</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="dashboardConsultasTable">
                  <!-- Preenchido via JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Consultas Section -->
      <div class="section" id="consultas">
        <div class="page-header">
          <h1 class="page-title">Gerenciar Consultas</h1>
          <p class="page-subtitle">Visualize e gerencie todas as suas consultas.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Filtros</span>
          </div>
          <div class="card-content">
            <div class="filter-panel">
              <div class="filter-grid">
                <div class="form-group">
                  <label>Status</label>
                  <select id="filterStatus" onchange="applyFilters()">
                    <option value="">Todos</option>
                    <option value="Confirmada">Confirmada</option>
                    <option value="Pendente">Pendente</option>
                    <option value="Cancelada">Cancelada</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Tipo</label>
                  <select id="filterTipo" onchange="applyFilters()">
                    <option value="">Todos</option>
                    <option value="Presencial">Presencial</option>
                    <option value="Online">Online</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Data Inicial</label>
                  <input type="date" id="filterDataInicio" onchange="applyFilters()">
                </div>
                <div class="form-group">
                  <label>Data Final</label>
                  <input type="date" id="filterDataFim" onchange="applyFilters()">
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Todas as Consultas</span>
            <div class="btn-group">
              <button class="btn btn-outline" onclick="exportConsultations()">
                <i class="fas fa-download"></i> Exportar
              </button>
              <button class="btn btn-primary" onclick="showModal('addAppointmentModal')">
                <i class="fas fa-plus"></i> Nova Consulta
              </button>
            </div>
          </div>
          <div class="card-content">
            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Paciente</th>
                    <th>Data/Hora</th>
                    <th>Tipo</th>
                    <th>Status</th>
                    <th>Valor</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="consultasTable">
                  <!-- Preenchido via JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Pacientes Section -->
      <div class="section" id="pacientes">
        <div class="page-header">
          <h1 class="page-title">Meus Pacientes</h1>
          <p class="page-subtitle">Gerencie informações dos seus pacientes.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Buscar Paciente</span>
          </div>
          <div class="card-content">
            <div class="form-group">
              <input type="text" id="searchPaciente" placeholder="Digite o nome do paciente..." onkeyup="searchPatients()">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Lista de Pacientes</span>
            <div class="btn-group">
              <button class="btn btn-outline" onclick="exportPatients()">
                <i class="fas fa-download"></i> Exportar
              </button>
              <button class="btn btn-primary" onclick="showModal('addPatientModal')">
                <i class="fas fa-user-plus"></i> Novo Paciente
              </button>
            </div>
          </div>
          <div class="card-content">
            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Idade</th>
                    <th>Responsável</th>
                    <th>Telefone</th>
                    <th>Última Consulta</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="pacientesTable">
                  <!-- Preenchido via JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Avaliações Section -->
      <div class="section" id="avaliacoes">
        <div class="page-header">
          <h1 class="page-title">Avaliações</h1>
          <p class="page-subtitle">Veja o feedback dos seus pacientes.</p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon warning">
              <i class="fas fa-star"></i>
            </div>
            <div class="stat-value">4.8</div>
            <div class="stat-label">Avaliação Média</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon primary">
              <i class="fas fa-comments"></i>
            </div>
            <div class="stat-value" id="totalAvaliacoes">156</div>
            <div class="stat-label">Total de Avaliações</div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Últimas Avaliações</span>
          </div>
          <div class="card-content" id="avaliacoesContent">
            <!-- Preenchido via JavaScript -->
          </div>
        </div>
      </div>

      <!-- Conteúdos Section -->
      <div class="section" id="conteudos">
        <div class="page-header">
          <h1 class="page-title">Conteúdos Educativos</h1>
          <p class="page-subtitle">Gerencie materiais e recursos para seus pacientes.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Meus Conteúdos</span>
            <button class="btn btn-primary" onclick="showModal('addContentModal')">
              <i class="fas fa-plus"></i> Novo Conteúdo
            </button>
          </div>
          <div class="card-content" id="conteudosGrid">
            <!-- Preenchido via JavaScript -->
          </div>
        </div>
      </div>

      <!-- Agenda Section -->
      <div class="section" id="agenda">
        <div class="page-header">
          <h1 class="page-title">Minha Agenda</h1>
          <p class="page-subtitle">Visualize e gerencie sua disponibilidade.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Configurar Horários</span>
          </div>
          <div class="card-content">
            <div class="form-group">
              <label>Dia da Semana</label>
              <select id="agendaDia">
                <option>Segunda-feira</option>
                <option>Terça-feira</option>
                <option>Quarta-feira</option>
                <option>Quinta-feira</option>
                <option>Sexta-feira</option>
                <option>Sábado</option>
                <option>Domingo</option>
              </select>
            </div>
            <div class="filter-grid">
              <div class="form-group">
                <label>Horário Início</label>
                <input type="time" id="agendaInicio" value="09:00">
              </div>
              <div class="form-group">
                <label>Horário Fim</label>
                <input type="time" id="agendaFim" value="18:00">
              </div>
            </div>
            <button class="btn btn-primary" onclick="saveAgenda()">
              <i class="fas fa-save"></i> Salvar Horário
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Horários Configurados</span>
          </div>
          <div class="card-content" id="agendaList">
            <!-- Preenchido via JavaScript -->
          </div>
        </div>
      </div>

      <!-- Perfil Section -->
      <div class="section" id="perfil">
        <div class="page-header">
          <h1 class="page-title">Meu Perfil</h1>
          <p class="page-subtitle">Gerencie suas informações pessoais e profissionais.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Informações Pessoais</span>
          </div>
          <div class="card-content">
            <div class="form-group">
              <label>Nome Completo</label>
              <input type="text" id="perfilNome" value="Marina Fernandes">
            </div>
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="perfilEmail" value="marina.fernandes@mentesbrilhantes.com.br">
            </div>
            <div class="filter-grid">
              <div class="form-group">
                <label>Telefone</label>
                <input type="tel" id="perfilTelefone" value="(11) 98765-4321">
              </div>
              <div class="form-group">
                <label>CRP</label>
                <input type="text" id="perfilCRP" value="06/123456">
              </div>
            </div>
            <div class="form-group">
              <label>Especialidade</label>
              <input type="text" id="perfilEspecialidade" value="Psicologia Infantil">
            </div>
            <div class="form-group">
              <label>Biografia</label>
              <textarea id="perfilBio">Psicóloga especializada em desenvolvimento infantil com mais de 10 anos de experiência.</textarea>
            </div>
            <div class="btn-group">
              <button class="btn btn-secondary" onclick="cancelEdit()">
                <i class="fas fa-times"></i> Cancelar
              </button>
              <button class="btn btn-primary" onclick="saveProfile()">
                <i class="fas fa-save"></i> Salvar Alterações
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Configurações Section -->
      <div class="section" id="configuracoes">
        <div class="page-header">
          <h1 class="page-title">Configurações</h1>
          <p class="page-subtitle">Personalize suas preferências do sistema.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Notificações</span>
          </div>
          <div class="card-content">
            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 10px;">
                <input type="checkbox" id="notifEmail" checked style="width: auto;">
                Receber notificações por email
              </label>
            </div>
            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 10px;">
                <input type="checkbox" id="notifSMS" style="width: auto;">
                Receber notificações por SMS
              </label>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Segurança</span>
          </div>
          <div class="card-content">
            <div class="form-group">
              <label>Senha Atual</label>
              <input type="password" id="senhaAtual">
            </div>
            <div class="form-group">
              <label>Nova Senha</label>
              <input type="password" id="senhaNova">
            </div>
            <div class="form-group">
              <label>Confirmar Nova Senha</label>
              <input type="password" id="senhaConfirm">
            </div>
            <button class="btn btn-primary" onclick="changePassword()">
              <i class="fas fa-lock"></i> Alterar Senha
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modais -->
  <!-- Modal Nova Consulta -->
  <div class="modal" id="addAppointmentModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('addAppointmentModal')">
        <i class="fas fa-times"></i>
      </button>
      <h3>Nova Consulta</h3>
      <div class="form-group">
        <label>Paciente</label>
        <select id="consultaPaciente">
          <option value="">Selecione um paciente</option>
        </select>
      </div>
      <div class="form-group">
        <label>Data e Hora</label>
        <input type="datetime-local" id="consultaDataHora">
      </div>
      <div class="form-group">
        <label>Tipo</label>
        <select id="consultaTipo">
          <option>Presencial</option>
          <option>Online</option>
        </select>
      </div>
      <div class="form-group">
        <label>Valor (R$)</label>
        <input type="number" id="consultaValor" value="280" step="10">
      </div>
      <div class="form-group">
        <label>Observações</label>
        <textarea id="consultaObs" placeholder="Observações adicionais..."></textarea>
      </div>
      <div class="btn-group">
        <button class="btn btn-secondary" onclick="closeModal('addAppointmentModal')">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button class="btn btn-primary" onclick="addAppointment()">
          <i class="fas fa-save"></i> Salvar
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Novo Paciente -->
  <div class="modal" id="addPatientModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('addPatientModal')">
        <i class="fas fa-times"></i>
      </button>
      <h3>Novo Paciente</h3>
      <div class="form-group">
        <label>Nome Completo</label>
        <input type="text" id="pacienteNome" placeholder="Nome do paciente">
      </div>
      <div class="form-group">
        <label>Data de Nascimento</label>
        <input type="date" id="pacienteDataNasc">
      </div>
      <div class="form-group">
        <label>Nome do Responsável</label>
        <input type="text" id="pacienteResponsavel" placeholder="Nome do responsável">
      </div>
      <div class="form-group">
        <label>Telefone</label>
        <input type="tel" id="pacienteTelefone" placeholder="(11) 98765-4321">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="pacienteEmail" placeholder="email@exemplo.com">
      </div>
      <div class="form-group">
        <label>Observações</label>
        <textarea id="pacienteObs" placeholder="Informações relevantes sobre o paciente..."></textarea>
      </div>
      <div class="btn-group">
        <button class="btn btn-secondary" onclick="closeModal('addPatientModal')">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button class="btn btn-primary" onclick="addPatient()">
          <i class="fas fa-save"></i> Salvar
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Visualizar Consulta -->
  <div class="modal" id="viewAppointmentModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('viewAppointmentModal')">
        <i class="fas fa-times"></i>
      </button>
      <h3>Detalhes da Consulta</h3>
      <div id="appointmentDetails"></div>
    </div>
  </div>

  <!-- Modal Visualizar Paciente -->
  <div class="modal" id="viewPatientModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('viewPatientModal')">
        <i class="fas fa-times"></i>
      </button>
      <h3>Detalhes do Paciente</h3>
      <div id="patientDetails"></div>
    </div>
  </div>

  <!-- Modal Novo Conteúdo -->
  <div class="modal" id="addContentModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('addContentModal')">
        <i class="fas fa-times"></i>
      </button>
      <h3>Novo Conteúdo</h3>
      <div class="form-group">
        <label>Título</label>
        <input type="text" id="contentTitulo" placeholder="Título do conteúdo">
      </div>
      <div class="form-group">
        <label>Tipo</label>
        <select id="contentTipo">
          <option>Artigo</option>
          <option>Vídeo</option>
          <option>PDF</option>
          <option>Link</option>
        </select>
      </div>
      <div class="form-group">
        <label>Descrição</label>
        <textarea id="contentDesc" placeholder="Descrição do conteúdo..."></textarea>
      </div>
      <div class="form-group">
        <label>URL/Link</label>
        <input type="url" id="contentUrl" placeholder="https://...">
      </div>
      <div class="btn-group">
        <button class="btn btn-secondary" onclick="closeModal('addContentModal')">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button class="btn btn-primary" onclick="addContent()">
          <i class="fas fa-save"></i> Salvar
        </button>
      </div>
    </div>
  </div>

  <script>
    // ============= DADOS SIMULADOS =============
    let consultas = [
      { id: 1, paciente: "Lucas Silva", data: "2025-10-10T14:00", tipo: "Presencial", status: "Confirmada", valor: 320 },
      { id: 2, paciente: "Ana Souza", data: "2025-10-15T09:30", tipo: "Online", status: "Pendente", valor: 280 },
      { id: 3, paciente: "Gabriel Lima", data: "2025-10-12T16:00", tipo: "Presencial", status: "Confirmada", valor: 320 },
      { id: 4, paciente: "Mariana Costa", data: "2025-10-18T10:00", tipo: "Online", status: "Pendente", valor: 280 },
    ];

    let pacientes = [
      { id: 1, nome: "Gabriel Lima", dataNasc: "2016-05-12", responsavel: "Larissa Lima", telefone: "(11) 97700-1234", email: "larissa@email.com", ultimaConsulta: "2025-09-07", status: "Ativo" },
      { id: 2, nome: "Lucas Silva", dataNasc: "2014-03-20", responsavel: "Carlos Silva", telefone: "(11) 98888-5555", email: "carlos@email.com", ultimaConsulta: "2025-09-15", status: "Ativo" },
      { id: 3, nome: "Ana Souza", dataNasc: "2015-07-08", responsavel: "Fernanda Souza", telefone: "(11) 99999-3333", email: "fernanda@email.com", ultimaConsulta: "2025-09-20", status: "Ativo" },
      { id: 4, nome: "Mariana Costa", dataNasc: "2013-11-15", responsavel: "Roberto Costa", telefone: "(11) 97777-8888", email: "roberto@email.com", ultimaConsulta: "2025-08-30", status: "Ativo" },
    ];

    let avaliacoes = [
      { paciente: "Lucas Silva", nota: 5, comentario: "Excelente profissional! Muito atenciosa e dedicada.", data: "2025-09-20" },
      { paciente: "Ana Souza", nota: 5, comentario: "Minha filha adorou as sessões. Recomendo!", data: "2025-09-18" },
      { paciente: "Gabriel Lima", nota: 4, comentario: "Ótimo atendimento e ambiente acolhedor.", data: "2025-09-15" },
    ];

    let conteudos = [
      { id: 1, titulo: "Desenvolvimento Infantil", tipo: "Artigo", descricao: "Guia completo sobre marcos do desenvolvimento", url: "#" },
      { id: 2, titulo: "Lidando com Ansiedade", tipo: "Vídeo", descricao: "Técnicas para ajudar crianças ansiosas", url: "#" },
      { id: 3, titulo: "Rotina Saudável", tipo: "PDF", descricao: "Dicas para estabelecer rotinas", url: "#" },
    ];

    let horarios = [
      { dia: "Segunda-feira", inicio: "09:00", fim: "18:00" },
      { dia: "Quarta-feira", inicio: "09:00", fim: "18:00" },
      { dia: "Sexta-feira", inicio: "09:00", fim: "16:00" },
    ];

    // ============= NAVEGAÇÃO =============
    function navigateTo(section) {
      // Remover classe active de todas as seções e nav-items
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      
      // Adicionar classe active na seção e nav-item correspondente
      document.getElementById(section).classList.add('active');
      const navItem = document.querySelector(`[data-section="${section}"]`);
      if (navItem) navItem.classList.add('active');
      
      // Carregar dados da seção
      loadSectionData(section);
      
      // Fechar dropdown do usuário se estiver aberto
      document.getElementById('userDropdown').classList.remove('active');
    }

    // Event listeners para navegação
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', (e) => {
        e.preventDefault();
        const section = item.getAttribute('data-section');
        navigateTo(section);
      });
    });

    // ============= MODAIS =============
    function showModal(id) {
      document.getElementById(id).classList.add('active');
      if (id === 'addAppointmentModal') {
        loadPatientOptions();
      }
    }

    function closeModal(id) {
      document.getElementById(id).classList.remove('active');
    }

    // Fechar modal clicando fora
    document.querySelectorAll('.modal').forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('active');
        }
      });
    });

    // ============= USER DROPDOWN =============
    function toggleUserDropdown() {
      const dropdown = document.getElementById('userDropdown');
      dropdown.classList.toggle('active');
    }

    // Fechar dropdown ao clicar fora
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.user-profile')) {
        document.getElementById('userDropdown').classList.remove('active');
      }
    });

    function logout() {
      if (confirm('Deseja realmente sair do sistema?')) {
        alert('Logout realizado com sucesso!');
        window.location.href = '../index.html';
      }
    }

    // ============= CARREGAR DADOS DAS SEÇÕES =============
    function loadSectionData(section) {
      switch(section) {
        case 'dashboard':
          renderDashboardConsultas();
          updateStats();
          break;
        case 'consultas':
          renderConsultas();
          break;
        case 'pacientes':
          renderPacientes();
          break;
        case 'avaliacoes':
          renderAvaliacoes();
          break;
        case 'conteudos':
          renderConteudos();
          break;
        case 'agenda':
          renderAgenda();
          break;
      }
    }

    // ============= DASHBOARD =============
    function updateStats() {
      document.getElementById('totalConsultas').textContent = consultas.length;
      document.getElementById('totalPacientes').textContent = pacientes.length;
      const receita = consultas.reduce((sum, c) => sum + c.valor, 0);
      document.getElementById('receitaMensal').textContent = `R$ ${receita.toLocaleString('pt-BR')}`;
      document.getElementById('totalAvaliacoes').textContent = avaliacoes.length;
    }

    function renderDashboardConsultas() {
      const tbody = document.getElementById('dashboardConsultasTable');
      const proximasConsultas = consultas.slice(0, 3);
      
      tbody.innerHTML = proximasConsultas.map(c => `
        <tr>
          <td>${c.paciente}</td>
          <td>${formatDateTime(c.data)}</td>
          <td>${c.tipo}</td>
          <td><span class="badge ${getStatusBadge(c.status)}">${c.status}</span></td>
        </tr>
      `).join('');
    }

    // ============= CONSULTAS =============
    function renderConsultas() {
      const tbody = document.getElementById('consultasTable');
      const consultasFiltradas = applyFilters();
      
      if (consultasFiltradas.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7">
              <div class="empty-state">
                <i class="fas fa-calendar-times"></i>
                <h3>Nenhuma consulta encontrada</h3>
                <p>Adicione uma nova consulta para começar.</p>
              </div>
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = consultasFiltradas.map(c => `
        <tr>
          <td>#${c.id}</td>
          <td>${c.paciente}</td>
          <td>${formatDateTime(c.data)}</td>
          <td>${c.tipo}</td>
          <td><span class="badge ${getStatusBadge(c.status)}">${c.status}</span></td>
          <td>R$ ${c.valor}</td>
          <td>
            <button class="action-btn view" title="Ver" onclick="viewAppointment(${c.id})">
              <i class="fas fa-eye"></i>
            </button>
            <button class="action-btn edit" title="Editar" onclick="editAppointment(${c.id})">
              <i class="fas fa-edit"></i>
            </button>
            <button class="action-btn delete" title="Excluir" onclick="deleteAppointment(${c.id})">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      `).join('');
    }

    function applyFilters() {
      const status = document.getElementById('filterStatus')?.value || '';
      const tipo = document.getElementById('filterTipo')?.value || '';
      const dataInicio = document.getElementById('filterDataInicio')?.value || '';
      const dataFim = document.getElementById('filterDataFim')?.value || '';
      
      return consultas.filter(c => {
        if (status && c.status !== status) return false;
        if (tipo && c.tipo !== tipo) return false;
        if (dataInicio && new Date(c.data) < new Date(dataInicio)) return false;
        if (dataFim && new Date(c.data) > new Date(dataFim)) return false;
        return true;
      });
    }

    function loadPatientOptions() {
      const select = document.getElementById('consultaPaciente');
      select.innerHTML = '<option value="">Selecione um paciente</option>' +
        pacientes.map(p => `<option value="${p.id}">${p.nome}</option>`).join('');
    }

    function addAppointment() {
      const pacienteId = document.getElementById('consultaPaciente').value;
      const dataHora = document.getElementById('consultaDataHora').value;
      const tipo = document.getElementById('consultaTipo').value;
      const valor = parseFloat(document.getElementById('consultaValor').value);
      
      if (!pacienteId || !dataHora) {
        alert('Por favor, preencha todos os campos obrigatórios!');
        return;
      }
      
      const paciente = pacientes.find(p => p.id == pacienteId);
      const novaConsulta = {
        id: consultas.length + 1,
        paciente: paciente.nome,
        data: dataHora,
        tipo: tipo,
        status: "Pendente",
        valor: valor
      };
      
      consultas.push(novaConsulta);
      closeModal('addAppointmentModal');
      alert('Consulta agendada com sucesso!');
      renderConsultas();
      updateStats();
    }

    function viewAppointment(id) {
      const consulta = consultas.find(c => c.id === id);
      const details = document.getElementById('appointmentDetails');
      
      details.innerHTML = `
        <div style="margin-bottom: 1rem;">
          <strong>ID:</strong> #${consulta.id}<br>
          <strong>Paciente:</strong> ${consulta.paciente}<br>
          <strong>Data/Hora:</strong> ${formatDateTime(consulta.data)}<br>
          <strong>Tipo:</strong> ${consulta.tipo}<br>
          <strong>Status:</strong> <span class="badge ${getStatusBadge(consulta.status)}">${consulta.status}</span><br>
          <strong>Valor:</strong> R$ ${consulta.valor}
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="closeModal('viewAppointmentModal')">
            <i class="fas fa-check"></i> OK
          </button>
        </div>
      `;
      
      showModal('viewAppointmentModal');
    }

    function editAppointment(id) {
      alert(`Funcionalidade de edição da consulta #${id} será implementada em breve!`);
    }

    function deleteAppointment(id) {
      if (confirm('Tem certeza que deseja excluir esta consulta?')) {
        consultas = consultas.filter(c => c.id !== id);
        renderConsultas();
        updateStats();
        alert('Consulta excluída com sucesso!');
      }
    }

    function exportConsultations() {
      const csv = 'ID,Paciente,Data/Hora,Tipo,Status,Valor\n' +
        consultas.map(c => `${c.id},${c.paciente},${c.data},${c.tipo},${c.status},${c.valor}`).join('\n');
      
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'consultas_export.csv';
      a.click();
      alert('Consultas exportadas com sucesso!');
    }

    // ============= PACIENTES =============
    function renderPacientes() {
      const tbody = document.getElementById('pacientesTable');
      
      if (pacientes.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="8">
              <div class="empty-state">
                <i class="fas fa-users"></i>
                <h3>Nenhum paciente cadastrado</h3>
                <p>Adicione um novo paciente para começar.</p>
              </div>
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = pacientes.map(p => {
        const idade = calcularIdade(p.dataNasc);
        return `
          <tr>
            <td>#${p.id}</td>
            <td>${p.nome}</td>
            <td>${idade} anos</td>
            <td>${p.responsavel}</td>
            <td>${p.telefone}</td>
            <td>${formatDate(p.ultimaConsulta)}</td>
            <td><span class="badge ${getStatusBadge(p.status)}">${p.status}</span></td>
            <td>
              <button class="action-btn view" title="Ver" onclick="viewPatient(${p.id})">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit" title="Editar" onclick="editPatient(${p.id})">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete" title="Excluir" onclick="deletePatient(${p.id})">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function searchPatients() {
      const search = document.getElementById('searchPaciente').value.toLowerCase();
      const tbody = document.getElementById('pacientesTable');
      
      const filtered = pacientes.filter(p => 
        p.nome.toLowerCase().includes(search) || 
        p.responsavel.toLowerCase().includes(search)
      );
      
      if (filtered.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="8">
              <div class="empty-state">
                <i class="fas fa-search"></i>
                <h3>Nenhum paciente encontrado</h3>
                <p>Tente buscar por outro nome.</p>
              </div>
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = filtered.map(p => {
        const idade = calcularIdade(p.dataNasc);
        return `
          <tr>
            <td>#${p.id}</td>
            <td>${p.nome}</td>
            <td>${idade} anos</td>
            <td>${p.responsavel}</td>
            <td>${p.telefone}</td>
            <td>${formatDate(p.ultimaConsulta)}</td>
            <td><span class="badge ${getStatusBadge(p.status)}">${p.status}</span></td>
            <td>
              <button class="action-btn view" title="Ver" onclick="viewPatient(${p.id})">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit" title="Editar" onclick="editPatient(${p.id})">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete" title="Excluir" onclick="deletePatient(${p.id})">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function addPatient() {
      const nome = document.getElementById('pacienteNome').value;
      const dataNasc = document.getElementById('pacienteDataNasc').value;
      const responsavel = document.getElementById('pacienteResponsavel').value;
      const telefone = document.getElementById('pacienteTelefone').value;
      const email = document.getElementById('pacienteEmail').value;
      
      if (!nome || !dataNasc || !responsavel || !telefone) {
        alert('Por favor, preencha todos os campos obrigatórios!');
        return;
      }
      
      const novoPaciente = {
        id: pacientes.length + 1,
        nome: nome,
        dataNasc: dataNasc,
        responsavel: responsavel,
        telefone: telefone,
        email: email,
        ultimaConsulta: new Date().toISOString().split('T')[0],
        status: "Ativo"
      };
      
      pacientes.push(novoPaciente);
      closeModal('addPatientModal');
      alert('Paciente cadastrado com sucesso!');
      renderPacientes();
      updateStats();
      
      // Limpar campos
      document.getElementById('pacienteNome').value = '';
      document.getElementById('pacienteDataNasc').value = '';
      document.getElementById('pacienteResponsavel').value = '';
      document.getElementById('pacienteTelefone').value = '';
      document.getElementById('pacienteEmail').value = '';
      document.getElementById('pacienteObs').value = '';
    }

    function viewPatient(id) {
      const paciente = pacientes.find(p => p.id === id);
      const idade = calcularIdade(paciente.dataNasc);
      const details = document.getElementById('patientDetails');
      
      details.innerHTML = `
        <div style="margin-bottom: 1rem;">
          <strong>ID:</strong> #${paciente.id}<br>
          <strong>Nome:</strong> ${paciente.nome}<br>
          <strong>Idade:</strong> ${idade} anos<br>
          <strong>Data de Nascimento:</strong> ${formatDate(paciente.dataNasc)}<br>
          <strong>Responsável:</strong> ${paciente.responsavel}<br>
          <strong>Telefone:</strong> ${paciente.telefone}<br>
          <strong>Email:</strong> ${paciente.email}<br>
          <strong>Última Consulta:</strong> ${formatDate(paciente.ultimaConsulta)}<br>
          <strong>Status:</strong> <span class="badge ${getStatusBadge(paciente.status)}">${paciente.status}</span>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="closeModal('viewPatientModal')">
            <i class="fas fa-check"></i> OK
          </button>
        </div>
      `;
      
      showModal('viewPatientModal');
    }

    function editPatient(id) {
      alert(`Funcionalidade de edição do paciente #${id} será implementada em breve!`);
    }

    function deletePatient(id) {
      if (confirm('Tem certeza que deseja remover este paciente?')) {
        pacientes = pacientes.filter(p => p.id !== id);
        renderPacientes();
        updateStats();
        alert('Paciente removido com sucesso!');
      }
    }

    function exportPatients() {
      const csv = 'ID,Nome,Data Nascimento,Responsável,Telefone,Email,Última Consulta,Status\n' +
        pacientes.map(p => `${p.id},${p.nome},${p.dataNasc},${p.responsavel},${p.telefone},${p.email},${p.ultimaConsulta},${p.status}`).join('\n');
      
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'pacientes_export.csv';
      a.click();
      alert('Pacientes exportados com sucesso!');
    }

    // ============= AVALIAÇÕES =============
    function renderAvaliacoes() {
      const container = document.getElementById('avaliacoesContent');
      
      if (avaliacoes.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-star"></i>
            <h3>Nenhuma avaliação ainda</h3>
            <p>As avaliações dos pacientes aparecerão aqui.</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = avaliacoes.map(a => `
        <div style="padding: 1rem; border-bottom: 1px solid var(--border); margin-bottom: 1rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
            <strong>${a.paciente}</strong>
            <div style="color: var(--warning-color);">
              ${'★'.repeat(a.nota)}${'☆'.repeat(5-a.nota)}
            </div>
          </div>
          <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">${a.comentario}</p>
          <small style="color: var(--text-secondary);">${formatDate(a.data)}</small>
        </div>
      `).join('');
    }

    // ============= CONTEÚDOS =============
    function renderConteudos() {
      const container = document.getElementById('conteudosGrid');
      
      if (conteudos.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-book"></i>
            <h3>Nenhum conteúdo cadastrado</h3>
            <p>Adicione materiais educativos para seus pacientes.</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem;">
          ${conteudos.map(c => `
            <div class="stat-card">
              <div class="stat-icon primary">
                <i class="fas fa-${getContentIcon(c.tipo)}"></i>
              </div>
              <h4 style="margin-bottom: 0.5rem;">${c.titulo}</h4>
              <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">${c.descricao}</p>
              <span class="badge primary">${c.tipo}</span>
              <div style="margin-top: 1rem;">
                <button class="action-btn view" onclick="window.open('${c.url}', '_blank')">
                  <i class="fas fa-external-link-alt"></i>
                </button>
                <button class="action-btn edit" onclick="editContent(${c.id})">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn delete" onclick="deleteContent(${c.id})">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function addContent() {
      const titulo = document.getElementById('contentTitulo').value;
      const tipo = document.getElementById('contentTipo').value;
      const descricao = document.getElementById('contentDesc').value;
      const url = document.getElementById('contentUrl').value;
      
      if (!titulo || !descricao || !url) {
        alert('Por favor, preencha todos os campos!');
        return;
      }
      
      const novoConteudo = {
        id: conteudos.length + 1,
        titulo: titulo,
        tipo: tipo,
        descricao: descricao,
        url: url
      };
      
      conteudos.push(novoConteudo);
      closeModal('addContentModal');
      alert('Conteúdo adicionado com sucesso!');
      renderConteudos();
      
      // Limpar campos
      document.getElementById('contentTitulo').value = '';
      document.getElementById('contentDesc').value = '';
      document.getElementById('contentUrl').value = '';
    }

    function editContent(id) {
      alert(`Funcionalidade de edição do conteúdo #${id} será implementada em breve!`);
    }

    function deleteContent(id) {
      if (confirm('Tem certeza que deseja excluir este conteúdo?')) {
        conteudos = conteudos.filter(c => c.id !== id);
        renderConteudos();
        alert('Conteúdo excluído com sucesso!');
      }
    }

    function getContentIcon(tipo) {
      const icons = {
        'Artigo': 'file-alt',
        'Vídeo': 'video',
        'PDF': 'file-pdf',
        'Link': 'link'
      };
      return icons[tipo] || 'file';
    }

    // ============= AGENDA =============
    function renderAgenda() {
      const container = document.getElementById('agendaList');
      
      if (horarios.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-clock"></i>
            <h3>Nenhum horário configurado</h3>
            <p>Configure seus horários de atendimento.</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = horarios.map((h, index) => `
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--background); border-radius: 10px; margin-bottom: 0.5rem;">
          <div>
            <strong>${h.dia}</strong><br>
            <span style="color: var(--text-secondary);">${h.inicio} - ${h.fim}</span>
          </div>
          <button class="action-btn delete" onclick="deleteHorario(${index})">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      `).join('');
    }

    function saveAgenda() {
      const dia = document.getElementById('agendaDia').value;
      const inicio = document.getElementById('agendaInicio').value;
      const fim = document.getElementById('agendaFim').value;
      
      if (!inicio || !fim) {
        alert('Por favor, preencha os horários!');
        return;
      }
      
      // Verificar se já existe horário para este dia
      const exists = horarios.findIndex(h => h.dia === dia);
      if (exists !== -1) {
        if (confirm('Já existe um horário configurado para este dia. Deseja substituir?')) {
          horarios[exists] = { dia, inicio, fim };
        } else {
          return;
        }
      } else {
        horarios.push({ dia, inicio, fim });
      }
      
      alert('Horário configurado com sucesso!');
      renderAgenda();
    }

    function deleteHorario(index) {
      if (confirm('Deseja remover este horário?')) {
        horarios.splice(index, 1);
        renderAgenda();
        alert('Horário removido com sucesso!');
      }
    }

    // ============= PERFIL E CONFIGURAÇÕES =============
    function saveProfile() {
      const nome = document.getElementById('perfilNome').value;
      const email = document.getElementById('perfilEmail').value;
      
      if (!nome || !email) {
        alert('Por favor, preencha todos os campos obrigatórios!');
        return;
      }
      
      alert('Perfil atualizado com sucesso!');
    }

    function cancelEdit() {
      if (confirm('Deseja descartar as alterações?')) {
        // Restaurar valores originais
        document.getElementById('perfilNome').value = "Marina Fernandes";
        document.getElementById('perfilEmail').value = "marina.fernandes@mentesbrilhantes.com.br";
        alert('Alterações descartadas.');
      }
    }

    function changePassword() {
      const atual = document.getElementById('senhaAtual').value;
      const nova = document.getElementById('senhaNova').value;
      const confirm = document.getElementById('senhaConfirm').value;
      
      if (!atual || !nova || !confirm) {
        alert('Por favor, preencha todos os campos!');
        return;
      }
      
      if (nova !== confirm) {
        alert('As senhas não coincidem!');
        return;
      }
      
      if (nova.length < 6) {
        alert('A senha deve ter pelo menos 6 caracteres!');
        return;
      }
      
      alert('Senha alterada com sucesso!');
      document.getElementById('senhaAtual').value = '';
      document.getElementById('senhaNova').value = '';
      document.getElementById('senhaConfirm').value = '';
    }

    // ============= FUNÇÕES AUXILIARES =============
    function formatDateTime(dateString) {
      const date = new Date(dateString);
      return date.toLocaleString('pt-BR', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('pt-BR');
    }

    function getStatusBadge(status) {
      const badges = {
        'Confirmada': 'success',
        'Pendente': 'warning',
        'Cancelada': 'error',
        'Ativo': 'success',
        'Inativo': 'error'
      };
      return badges[status] || 'primary';
    }

    function calcularIdade(dataNasc) {
      const hoje = new Date();
      const nascimento = new Date(dataNasc);
      let idade = hoje.getFullYear() - nascimento.getFullYear();
      const mes = hoje.getMonth() - nascimento.getMonth();
      if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
        idade--;
      }
      return idade;
    }

    // ============= INICIALIZAÇÃO =============
    document.addEventListener('DOMContentLoaded', function() {
      loadSectionData('dashboard');
    });
  </script>
</body>
</html>
