<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentes Brilhantes</title>
    <link rel="stylesheet" href="../css/cadastroneuro.css">
    <link rel="icon" type="image/x-icon" href="../img/LogoMB.png">
</head>
<body>
    <div class="container">
        <div class="left-side">
            <div class="logo">
                <img src="../img/LogoMB.png" alt="Logo" />
            </div>
        </div>
        
        <div class="right-side">
            <div class="register-form">
                <h1 class="form-title">Cadastro do Neurodivergente</h1>
                <p class="form-subtitle">Agora vamos registrar os dados da pessoa autista sob sua responsabilidade</p>
                
                <form id="registerForm" action="../php/cad_neurodivergente.php" method="post" enctype="multipart/form-data">
                    <!-- Foto de Perfil -->
                    <div class="profile-photo-section">
                        <div class="profile-photo-container" onclick="document.getElementById('profilePhoto').click()">
                            <img id="profilePhotoPreview" class="profile-photo" alt="Foto de perfil">
                            <div class="profile-photo-placeholder">üì∑</div>
                        </div>
                        <label class="profile-photo-label" for="profilePhoto">Adicionar foto</label>
                        <input type="file" id="profilePhoto" name="perfil" class="profile-photo-input" accept="image/*">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="nome">Nome Completo:</label>
                        <input type="text" id="nome" name="nome" class="form-input" placeholder="Digite o nome completo" required>
                        <div class="error-message" id="nomeError">Nome completo deve ser preenchido</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="email">E-mail:</label>
                        <input type="email" id="email" name="email" class="form-input" placeholder="Digite o e-mail" required>
                        <div class="error-message" id="emailError">E-mail v√°lido deve ser preenchido</div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="rg">RG:</label>
                            <input type="text" id="rg" name="rg" class="form-input" placeholder="00.000.000-0" maxlength="12" required>
                            <div class="error-message" id="rgError">RG deve ser preenchido</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="cpf">CPF:</label>
                            <input type="text" id="cpf" name="cpf" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
                            <div class="error-message" id="cpfError">CPF deve ter 11 d√≠gitos e ser v√°lido</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="sexo">Sexo:</label>
                            <select id="sexo" name="sexo" class="form-input" required>
                                <option value="">Selecione</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Feminino">Feminino</option>
                            </select>
                            <div class="error-message" id="sexoError">Sexo deve ser selecionado</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label optional" for="celular">*Celular (Opcional):</label>
                            <input type="tel" id="celular" name="celular" class="form-input" placeholder="(00) 00000-0000" maxlength="15">
                            <div class="error-message" id="celularError">Celular deve ter 11 d√≠gitos (DDD + n√∫mero)</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="cep">CEP:</label>
                            <input type="text" id="cep" name="cep" class="form-input" placeholder="00000-000" maxlength="9" required>
                            <div class="error-message" id="cepError">CEP v√°lido √© obrigat√≥rio</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="rua">Rua:</label>
                            <input type="text" id="rua" name="rua" class="form-input" placeholder="Nome da rua" required>
                            <div class="error-message" id="ruaError">Rua deve ser preenchida</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="bairro">Bairro:</label>
                            <input type="text" id="bairro" name="bairro" class="form-input" placeholder="Bairro" required>
                            <div class="error-message" id="bairroError">Bairro deve ser preenchido</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="cidade">Cidade:</label>
                            <input type="text" id="cidade" name="cidade" class="form-input" placeholder="Cidade" required>
                            <div class="error-message" id="cidadeError">Cidade deve ser preenchida</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="numero">N√∫mero:</label>
                            <input type="text" id="numero" name="numero" class="form-input" placeholder="N¬∫" required>
                            <div class="error-message" id="numeroError">N√∫mero deve ser preenchido</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label optional" for="complemento">*Complemento (Opcional):</label>
                            <input type="text" id="complemento" name="complemento" class="form-input" placeholder="Apt, Bloco, Casa, etc.">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="senha">Senha:</label>
                            <input type="password" id="senha" name="senha" class="form-input" placeholder="Digite a senha" required>
                            <div class="error-message" id="senhaError">Senha deve ter pelo menos 6 caracteres</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="confirmPassword">Confirmar Senha:</label>
                            <input type="password" id="confirmPassword" class="form-input" placeholder="Confirme a senha" required>
                            <div class="error-message" id="confirmPasswordError">Senhas devem coincidir</div>
                        </div>
                    </div>
                    
                    <button type="submit" class="register-btn">Finalizar Cadastro</button>
                </form>
                
                <div class="social-login">
                    <div class="social-btn" onclick="alert('Funcionalidade em desenvolvimento')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M18.71 19.5C17.88 20.74 17 21.95 15.66 21.97C14.32 22 13.89 21.18 12.37 21.18C10.84 21.18 10.37 21.95 9.09997 22C7.78997 22.05 6.79997 20.68 5.95997 19.47C4.24997 17 2.93997 12.45 4.69997 9.39C5.56997 7.87 7.12997 6.91 8.81997 6.88C10.1 6.86 11.32 7.75 12.11 7.75C12.89 7.75 14.37 6.68 15.92 6.84C16.57 6.87 18.39 7.1 19.56 8.82C19.47 8.88 17.39 10.1 17.41 12.63C17.44 15.65 20.06 16.66 20.09 16.67C20.06 16.74 19.67 18.11 18.71 19.5ZM13 3.5C13.73 2.67 14.94 2.04 15.94 2C16.07 3.17 15.6 4.35 14.9 5.19C14.21 6.04 13.07 6.7 11.95 6.61C11.8 5.46 12.36 4.26 13 3.5Z" fill="currentColor"/>
                        </svg>
                    </div>
                    <div class="social-btn" onclick="alert('Funcionalidade em desenvolvimento')">
                        <svg width="20" height="20" viewBox="0 0 24 24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                </div>
                
                <div class="terms">
                    Ao finalizar o cadastro, voc√™ concorda com nossos <a href="#" onclick="showModal('termsModal'); return false;">Termos de Uso</a> e <a href="#" onclick="showModal('privacyModal'); return false;">Pol√≠tica de Privacidade</a>
                </div>

                <div class="login-link">
                    <p>J√° tem uma conta? <a href="login.html">Fa√ßa login</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Sucesso -->
    <div class="success-modal" id="successModal">
        <div class="success-modal-content">
            <h2>‚úÖ Cadastro conclu√≠do com sucesso!</h2>
            <p>O cadastro do neurodivergente foi realizado com sucesso. Voc√™s j√° podem acessar a plataforma e aproveitar todos os recursos dispon√≠veis!</p>
            <button onclick="closeSuccessModal()">Ir para o in√≠cio</button>
        </div>
    </div>

    <!-- Modais de Termos e Privacidade -->
    <div class="modal-overlay" id="termsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Termos de Uso</h2>
                <button class="modal-close" onclick="closeModal('termsModal')">&times;</button>
            </div>
            <div class="modal-body">
                <h3>Termos de Uso - Mentes Brilhantes</h3>
                <p><strong>√öltima atualiza√ß√£o:</strong> Agosto de 2025</p>
                
                <h4>1. Aceita√ß√£o dos Termos</h4>
                <p>Ao acessar e utilizar o site Mentes Brilhantes, voc√™ concorda em cumprir estes Termos de Uso. Se n√£o concordar com qualquer parte destes termos, n√£o utilize nossos servi√ßos.</p>

                <h4>2. Descri√ß√£o do Servi√ßo</h4>
                <p>O Mentes Brilhantes √© uma campanha de conscientiza√ß√£o e valoriza√ß√£o do autismo que oferece:</p>
                <ul>
                    <li>Informa√ß√µes educacionais sobre TEA (Transtorno do Espectro Autista)</li>
                    <li>Recursos de apoio para fam√≠lias e cuidadores</li>
                    <li>Ferramentas de comunica√ß√£o e suporte</li>
                    <li>Acesso √† IA Luna para orienta√ß√£o especializada</li>
                </ul>

                <h4>3. Uso Apropriado</h4>
                <p>Voc√™ se compromete a:</p>
                <ul>
                    <li>Usar o site apenas para fins legais e apropriados</li>
                    <li>N√£o interferir no funcionamento do site</li>
                    <li>N√£o tentar acessar √°reas restritas</li>
                    <li>Respeitar os direitos autorais e de propriedade intelectual</li>
                    <li>N√£o transmitir conte√∫do ofensivo ou prejudicial</li>
                </ul>

                <h4>4. Cadastro e Conta de Usu√°rio</h4>
                <ul>
                    <li>Voc√™ √© respons√°vel por manter a confidencialidade de sua senha</li>
                    <li>Deve fornecer informa√ß√µes precisas e atualizadas</li>
                    <li>Notificar imediatamente sobre uso n√£o autorizado de sua conta</li>
                </ul>

                <h4>5. Contato</h4>
                <p>Para d√∫vidas sobre estes termos:</p>
                <ul>
                    <li>Email: mentesbrilhantestcc@gmail.com</li>
                    <li>Telefone: (11) 97349-2001</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button class="btn-modal-close" onclick="closeModal('termsModal')">Fechar</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="privacyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Pol√≠tica de Privacidade</h2>
                <button class="modal-close" onclick="closeModal('privacyModal')">&times;</button>
            </div>
            <div class="modal-body">
                <h3>Pol√≠tica de Privacidade - Mentes Brilhantes</h3>
                <p><strong>√öltima atualiza√ß√£o:</strong> Agosto de 2025</p>
                
                <h4>1. Informa√ß√µes que Coletamos</h4>
                <p>Coletamos apenas as informa√ß√µes necess√°rias para fornecer nossos servi√ßos de forma eficaz:</p>
                <ul>
                    <li><strong>Informa√ß√µes de Cadastro:</strong> Nome, email, telefone</li>
                    <li><strong>Informa√ß√µes de Uso:</strong> Como voc√™ navega e utiliza nosso site</li>
                    <li><strong>Informa√ß√µes T√©cnicas:</strong> Endere√ßo IP, navegador, dispositivo</li>
                </ul>

                <h4>2. Como Utilizamos suas Informa√ß√µes</h4>
                <ul>
                    <li>Fornecer e melhorar nossos servi√ßos</li>
                    <li>Comunicar sobre atualiza√ß√µes e novidades</li>
                    <li>Personalizar sua experi√™ncia</li>
                    <li>Garantir a seguran√ßa da plataforma</li>
                </ul>

                <h4>3. Seguran√ßa dos Dados</h4>
                <p>Implementamos medidas t√©cnicas e organizacionais apropriadas para proteger suas informa√ß√µes contra acesso n√£o autorizado.</p>

                <h4>4. Contato</h4>
                <p>Para exercer seus direitos ou esclarecer d√∫vidas:</p>
                <ul>
                    <li>Email: mentesbrilhantestcc@gmail.com</li>
                    <li>Telefone: (11) 97349-2001</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button class="btn-modal-close" onclick="closeModal('privacyModal')">Fechar</button>
            </div>
        </div>
    </div>

    <script>
        // Fun√ß√£o para preview da foto de perfil
        document.getElementById('profilePhoto').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('profilePhotoPreview');
                    const placeholder = document.querySelector('.profile-photo-placeholder');
                    
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    placeholder.style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        });

        // M√°scaras para os campos
        function applyRGMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{2})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d{1,2})/, '$1-$2')
                .replace(/(-\d{1})\d+?$/, '$1');
        }

        function applyCPFMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d{1,2})/, '$1-$2')
                .replace(/(-\d{2})\d+?$/, '$1');
        }

        function applyPhoneMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{2})(\d)/, '($1) $2')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .replace(/(-\d{4})\d+?$/, '$1');
        }

        function applyCEPMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .replace(/(-\d{3})\d+?$/, '$1');
        }

        // Fun√ß√£o para validar CPF
        function isValidCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            if (cpf.length !== 11) return false;
            if (/^(\d)\1{10}$/.test(cpf)) return false;
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += parseInt(cpf[i]) * (10 - i);
            }
            let digit1 = (sum * 10) % 11;
            if (digit1 === 10) digit1 = 0;
            
            sum = 0;
            for (let i = 0; i < 10; i++) {
                sum += parseInt(cpf[i]) * (11 - i);
            }
            let digit2 = (sum * 10) % 11;
            if (digit2 === 10) digit2 = 0;
            
            return digit1 === parseInt(cpf[9]) && digit2 === parseInt(cpf[10]);
        }

        // Fun√ß√£o para validar email
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Fun√ß√£o para mostrar erro
        function showError(fieldId, errorId, message) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(errorId);
            
            field.classList.add('error');
            error.textContent = message;
            error.style.display = 'block';
        }

        // Fun√ß√£o para limpar erro
        function clearError(fieldId, errorId) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(errorId);
            
            field.classList.remove('error');
            error.style.display = 'none';
        }

        // Aplicar m√°scaras aos campos
        document.getElementById('rg').addEventListener('input', function(e) {
            e.target.value = applyRGMask(e.target.value);
        });

        document.getElementById('cpf').addEventListener('input', function(e) {
            e.target.value = applyCPFMask(e.target.value);
        });

        document.getElementById('celular').addEventListener('input', function(e) {
            e.target.value = applyPhoneMask(e.target.value);
        });

        document.getElementById('cep').addEventListener('input', function(e) {
            e.target.value = applyCEPMask(e.target.value);
        });

        // Fun√ß√£o para buscar CEP
        document.getElementById('cep').addEventListener('blur', function(e) {
            const cep = e.target.value.replace(/\D/g, '');
            
            if (cep.length === 8) {
                document.getElementById('rua').value = '';
                document.getElementById('bairro').value = '';
                document.getElementById('cidade').value = '';
                
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (!data.erro) {
                            document.getElementById('rua').value = data.logradouro || '';
                            document.getElementById('bairro').value = data.bairro || '';
                            document.getElementById('cidade').value = data.localidade || '';
                            
                            if (data.logradouro) clearError('rua', 'ruaError');
                            if (data.bairro) clearError('bairro', 'bairroError');
                            if (data.localidade) clearError('cidade', 'cidadeError');
                            clearError('cep', 'cepError');
                        } else {
                            showError('cep', 'cepError', 'CEP n√£o encontrado');
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao buscar CEP:', error);
                        showError('cep', 'cepError', 'Erro ao buscar CEP. Verifique sua conex√£o');
                    });
            }
        });

        // Valida√ß√µes em tempo real
        document.getElementById('nome').addEventListener('blur', function(e) {
            const nome = e.target.value.trim();
            if (nome.length >= 2) {
                clearError('nome', 'nomeError');
            } else if (nome.length > 0) {
                showError('nome', 'nomeError', 'Nome completo deve ser preenchido');
            }
        });

        document.getElementById('email').addEventListener('blur', function(e) {
            const email = e.target.value.trim();
            if (email && !isValidEmail(email)) {
                showError('email', 'emailError', 'Formato de e-mail inv√°lido');
            } else if (email && isValidEmail(email)) {
                clearError('email', 'emailError');
            }
        });

        document.getElementById('rg').addEventListener('blur', function(e) {
            const rg = e.target.value.trim();
            if (rg && rg.length >= 8) {
                clearError('rg', 'rgError');
            } else if (rg && rg.length < 8) {
                showError('rg', 'rgError', 'RG deve ser preenchido corretamente');
            }
        });

        document.getElementById('cpf').addEventListener('blur', function(e) {
            const cpf = e.target.value;
            const cpfNumbers = cpf.replace(/\D/g, '');
            if (cpf && cpfNumbers.length === 11 && isValidCPF(cpf)) {
                clearError('cpf', 'cpfError');
            } else if (cpf && (cpfNumbers.length !== 11 || !isValidCPF(cpf))) {
                showError('cpf', 'cpfError', 'CPF deve ter 11 d√≠gitos e ser v√°lido');
            }
        });

        document.getElementById('celular').addEventListener('blur', function(e) {
            const celular = e.target.value.replace(/\D/g, '');
            if (celular && celular.length === 11) {
                clearError('celular', 'celularError');
            } else if (celular && celular.length > 0 && celular.length !== 11) {
                showError('celular', 'celularError', 'Celular deve ter 11 d√≠gitos (DDD + n√∫mero)');
            }
        });

        // Valida√ß√£o do campo Sexo
        document.getElementById('sexo').addEventListener('change', function(e) {
            const sexo = e.target.value;
            if (sexo) {
                clearError('sexo', 'sexoError');
            }
        });

        document.getElementById('senha').addEventListener('input', function(e) {
            const password = e.target.value;
            if (password.length >= 6) {
                clearError('senha', 'senhaError');
            } else if (password.length > 0) {
                showError('senha', 'senhaError', 'Senha deve ter pelo menos 6 caracteres');
            }
            
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (confirmPassword) {
                if (password === confirmPassword) {
                    clearError('confirmPassword', 'confirmPasswordError');
                } else {
                    showError('confirmPassword', 'confirmPasswordError', 'Senhas devem coincidir');
                }
            }
        });

        document.getElementById('confirmPassword').addEventListener('input', function(e) {
            const password = document.getElementById('senha').value;
            const confirmPassword = e.target.value;
            
            if (confirmPassword && password === confirmPassword) {
                clearError('confirmPassword', 'confirmPasswordError');
            } else if (confirmPassword && password !== confirmPassword) {
                showError('confirmPassword', 'confirmPasswordError', 'Senhas devem coincidir');
            }
        });

        document.querySelectorAll('.form-input').forEach(input => {
            input.addEventListener('focus', function() {
                const errorId = this.id + 'Error';
                clearError(this.id, errorId);
            });
        });

        // VALIDA√á√ÉO E ENVIO DO FORMUL√ÅRIO
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            let isValid = true;
            
            const errorElements = document.querySelectorAll('.error-message');
            errorElements.forEach(error => error.style.display = 'none');
            
            const inputElements = document.querySelectorAll('.form-input');
            inputElements.forEach(input => input.classList.remove('error'));
            
            const nome = document.getElementById('nome').value.trim();
            if (!nome || nome.length < 2) {
                showError('nome', 'nomeError', 'Nome completo deve ser preenchido');
                isValid = false;
            }
            
            const email = document.getElementById('email').value.trim();
            if (!email || !isValidEmail(email)) {
                showError('email', 'emailError', 'E-mail v√°lido deve ser preenchido');
                isValid = false;
            }

            const rg = document.getElementById('rg').value.trim();
            if (!rg || rg.length < 8) {
                showError('rg', 'rgError', 'RG deve ser preenchido');
                isValid = false;
            }
            
            const cpf = document.getElementById('cpf').value;
            const cpfNumbers = cpf.replace(/\D/g, '');
            if (!cpf || cpfNumbers.length !== 11 || !isValidCPF(cpf)) {
                showError('cpf', 'cpfError', 'CPF deve ter 11 d√≠gitos e ser v√°lido');
                isValid = false;
            }
            
            const celular = document.getElementById('celular').value.replace(/\D/g, '');
            if (celular && celular.length !== 11) {
                showError('celular', 'celularError', 'Celular deve ter 11 d√≠gitos (DDD + n√∫mero)');
                isValid = false;
            }
            
            const cep = document.getElementById('cep').value.replace(/\D/g, '');
            if (!cep || cep.length !== 8) {
                showError('cep', 'cepError', 'CEP v√°lido deve ser preenchido');
                isValid = false;
            }
            
            const rua = document.getElementById('rua').value.trim();
            if (!rua) {
                showError('rua', 'ruaError', 'Rua deve ser preenchida');
                isValid = false;
            }
            
            const bairro = document.getElementById('bairro').value.trim();
            if (!bairro) {
                showError('bairro', 'bairroError', 'Bairro deve ser preenchido');
                isValid = false;
            }
            
            const cidade = document.getElementById('cidade').value.trim();
            if (!cidade) {
                showError('cidade', 'cidadeError', 'Cidade deve ser preenchida');
                isValid = false;
            }
            
            const sexo = document.getElementById('sexo').value;
            if (!sexo) {
                showError('sexo', 'sexoError', 'Sexo deve ser selecionado');
                isValid = false;
            }
            
            const numero = document.getElementById('numero').value.trim();
            if (!numero) {
                showError('numero', 'numeroError', 'N√∫mero deve ser preenchido');
                isValid = false;
            }
            
            const senha = document.getElementById('senha').value;
            if (!senha || senha.length < 6) {
                showError('senha', 'senhaError', 'Senha deve ter pelo menos 6 caracteres');
                isValid = false;
            }
            
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (!confirmPassword || senha !== confirmPassword) {
                showError('confirmPassword', 'confirmPasswordError', 'Senhas devem coincidir');
                isValid = false;
            }
            
            if (isValid) {
                const formData = new FormData(this);
                const submitBtn = this.querySelector('.register-btn');
                submitBtn.disabled = true;
                submitBtn.textContent = 'Cadastrando...';
                
                fetch(this.action, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.text())
                .then(data => {
                    try {
                        const jsonData = JSON.parse(data);
                        if (jsonData.success) {
                            showSuccessModal();
                        } else {
                            alert('Erro: ' + jsonData.message);
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Finalizar Cadastro';
                        }
                    } catch (e) {
                        if (data.includes('CPF j√° cadastrado')) {
                            showError('cpf', 'cpfError', 'CPF j√° cadastrado no sistema');
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Finalizar Cadastro';
                        } else if (data.includes('RG j√° cadastrado')) {
                            showError('rg', 'rgError', 'RG j√° cadastrado no sistema');
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Finalizar Cadastro';
                        } else if (data.includes('sucesso') || data.includes('Dados salvos')) {
                            showSuccessModal();
                        } else {
                            alert('Erro ao processar cadastro: ' + data);
                            console.error('Resposta do servidor:', data);
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Finalizar Cadastro';
                        }
                    }
                })
                .catch(error => {
                    console.error('Erro:', error);
                    alert('Erro ao enviar formul√°rio. Verifique sua conex√£o e tente novamente.');
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Finalizar Cadastro';
                });
            } else {
                const firstError = document.querySelector('.form-input.error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    firstError.focus();
                }
            }
        });

        function showSuccessModal() {
            document.getElementById('successModal').style.display = 'flex';
        }

        function closeSuccessModal() {
            document.getElementById('successModal').style.display = 'none';
            setTimeout(() => {
                window.location.href = 'adm_responsavel.html';
            }, 300);
        }

        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }
    </script>
</body>
</html>
